<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>SAOM as ABM</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="prep.html">Preparation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Descriptives
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="des.html">Procedure</a>
    </li>
    <li>
      <a href="destab.html">Table 1: Descriptives</a>
    </li>
    <li>
      <a href="desfig.html">Figure 5: Development of the mean running</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Model selection
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="explore.html">Club 1</a>
    </li>
    <li>
      <a href="other.html">Clubs 2-5</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Meta-analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="meta.html">Running frequency models</a>
    </li>
    <li>
      <a href="vol_meta.html">Running volume models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    GOF
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GOF1.html">Running frequency models</a>
    </li>
    <li>
      <a href="GOF2.html">Running volume</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Influence effects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="influenceeffects.html">Different influence operationalizations</a>
    </li>
    <li>
      <a href="interaction.html">Interaction effects for influence dynamics</a>
    </li>
    <li>
      <a href="figure3.html">Figure 6: Ego-alter influence plot</a>
    </li>
    <li>
      <a href="RI.html">Figure 7: Relative importance of effects</a>
    </li>
    <li>
      <a href="simulations.html">Empirically calibrated ABMs</a>
    </li>
    <li>
      <a href="moderation.html">Post-hoc probing of moderational effects</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robfranken/Strava">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">SAOM as ABM</h1>
<h4 class="date">Last compiled on september, 2022</h4>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<hr />
<p>Aim: to explore how consequential influence effects are for the
running behavior (here, frequency) across clubs.</p>
<p>I reduced the data to only two time-points. Initial effect values are
set based on the estimated model parameters of tables 2 and 3 of the
manuscript.</p>
<p>I specify additional models: 1) with no peer influence effects
whatsoever; 2) with only indegree effect on behavior; 3) with only
upward assimilation (avAttHigher); 4) with only downward assimilation
(avAttLower).</p>
<p><span style="color: red;">only 100 simulations were run, but this can
be adjusted in the script!</span></p>
<hr />
<p><br></p>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<div id="clean-up" class="section level2">
<h2>clean up</h2>
<pre class="r test"><code>rm (list = ls( ))
#gc()</code></pre>
<p><br></p>
</div>
<div id="general-custom-functions" class="section level2">
<h2>general custom functions</h2>
<ul>
<li><code>fpackage.check</code>: Check if packages are installed (and
install if not) in R (<a
href="https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/">source</a>)</li>
<li><code>fload.R</code>: function to load R-objects under new
names.</li>
</ul>
<pre class="r test"><code>fpackage.check &lt;- function(packages) {
    lapply(packages, FUN = function(x) {
        if (!require(x, character.only = TRUE)) {
            install.packages(x, dependencies = TRUE)
            library(x, character.only = TRUE)
        }
    })
}

fload.R  &lt;- function(fileName){
  load(fileName)
  get(ls()[ls() != &quot;fileName&quot;])
}</code></pre>
</div>
<div id="necessary-packages" class="section level2">
<h2>necessary packages</h2>
<ul>
<li><code>RSiena</code>: SIENA as ABM</li>
<li><code>sna</code></li>
<li><code>lattice</code>: for plotting</li>
<li><code>RColorBrewer</code>: color palettes</li>
</ul>
<pre class="r test"><code>packages = c(&quot;RSiena&quot;, &quot;sna&quot;, &quot;lattice&quot;, &quot;RColorBrewer&quot;)

fpackage.check(packages)</code></pre>
<p><br></p>
</div>
<div id="load-club-data" class="section level2">
<h2>load club data</h2>
<p>Load the club list, to set up our starting networks</p>
<pre class="r test"><code>load(&quot;clubdata.RData&quot;)</code></pre>
<p><br></p>
<p>The following scripts makes for all clubs boxplots illustrating how
average running behavior values differ across different simulation
models.</p>
<p><strong>Models</strong>:</p>
<ul>
<li>model 5</li>
<li>no_inf</li>
<li>only indegree</li>
<li>only avAttLower</li>
<li>only avAttHigher</li>
</ul>
</div>
</div>
<div id="simulation-models" class="section level1">
<h1>simulation models</h1>
<pre class="r test"><code>plotL &lt;- list() # list to store plots in

for (c in 1:length(clubdata)) {

  # pick club

  club &lt;- clubdata[[c]]
  
  # we reduce the data to only two time points
  kudonet &lt;- sienaDependent(club$kudo[,,1:2], allowOnly = FALSE)
  freq_run &lt;- sienaDependent(club$freq_run[,,1:2], type = &quot;behavior&quot;, allowOnly = FALSE) 
  time_run &lt;- sienaDependent(club$time_run[,,1:2], type = &quot;behavior&quot;, allowOnly = FALSE) 
  
  # covariates
  # changing covariates not possible with only 2 waves, so we make other activity a constant
  freq_other &lt;- coCovar(club$freq_other[, ,1])
  time_other &lt;- coCovar(club$time_other[, ,1])
  gender &lt;- coCovar(ifelse(club$male == 1, 1, 2))
  
  # create a RSiena data object for both models: frequency and volume
  mydata &lt;- sienaDataCreate(kudonet, freq_run, freq_other, gender)
  mydata2&lt;- sienaDataCreate(kudonet, time_run, time_other, gender)
  
  # load in the sienaFit object list, containing estimated parameters
  # for the frequency and volume model
  load(paste0(&quot;test/sienaFit/sienaFit_club&quot;, c, &quot;.RData&quot;)) # freq.
  ans &lt;- sienaFit[[5]] # get object for main model (m5)
  load(paste0(&quot;test/sienaFit/duration/sienaFit_club&quot;, c, &quot;.RData&quot;)) # vol.
  ans2 &lt;- sienaFit[[5]]
  
  # make effects object
  myeff &lt;- getEffects(mydata)
  myeff2 &lt;- getEffects(mydata2)
  # set initial values of basic effects for simulations based on estimated model
  myeff$initialValue[myeff$include==T] &lt;- ans$theta[c(1,12,13,28,39,40)]
  myeff2$initialValue[myeff2$include==T] &lt;- ans2$theta[c(1,12,13,28,39,40)]
  
  # include extra effects and set initial value
  # frequency model
  {
    myeff &lt;- setEffect(myeff, gwespFF, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;gwespFF&quot;)])
    myeff &lt;- setEffect(myeff, outActSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outActSqrt&quot;)])
    myeff &lt;- setEffect(myeff, inPopSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;inPopSqrt&quot;)])
    myeff &lt;- setEffect(myeff, outPopSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outPopSqrt&quot;)])
    myeff &lt;- setEffect(myeff, reciAct, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;reciAct&quot;)])
    myeff &lt;- setEffect(myeff, outIso, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outIso&quot;)])
    myeff &lt;- includeInteraction(myeff, recip, gwespFF, parameter = 69, name = &quot;kudonet&quot;)
    (eff1 &lt;- myeff[myeff$include, ]$effect1[10])
    (eff2 &lt;- myeff[myeff$include, ]$effect2[10])
    myeff &lt;- setEffect(myeff, unspInt, effect1 = eff1, effect2 = eff2, initialValue = ans$theta[which(ans$effects$shortName==&quot;unspInt&quot;)])
    myeff &lt;- setEffect(myeff, higher, name = &quot;kudonet&quot;, interaction1 = &quot;freq_run&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;higher&quot;)])
    myeff &lt;- setEffect(myeff, egoX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;egoX&quot; &amp; ans$effects$interaction1==&quot;gender&quot;)])
    myeff &lt;- setEffect(myeff, altX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;altX&quot; &amp; ans$effects$interaction1==&quot;gender&quot;)])
    myeff &lt;- setEffect(myeff, sameX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;sameX&quot;&amp; ans$effects$interaction1==&quot;gender&quot;)])
    myeff &lt;- setEffect(myeff, effFrom, name = &quot;freq_run&quot;, interaction1 = &quot;freq_other&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;effFrom&quot; &amp; ans$effects$interaction1==&quot;freq_other&quot;)])
    myeff &lt;- setEffect(myeff, effFrom, name = &quot;freq_run&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;effFrom&quot; &amp; ans$effects$interaction1==&quot;gender&quot;)])
    myeff &lt;- setEffect(myeff, indeg, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;indeg&quot;)])
    myeff &lt;- setEffect(myeff, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttHigher&quot;)])
    myeff &lt;- setEffect(myeff, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttLower&quot;)])
  }
  
  # volume model
  {
    myeff2 &lt;- setEffect(myeff2, gwespFF, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;gwespFF&quot;)])
    myeff2 &lt;- setEffect(myeff2, outActSqrt, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;outActSqrt&quot;)])
    myeff2 &lt;- setEffect(myeff2, inPopSqrt, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;inPopSqrt&quot;)])
    myeff2 &lt;- setEffect(myeff2, outPopSqrt, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;outPopSqrt&quot;)])
    myeff2 &lt;- setEffect(myeff2, reciAct, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;reciAct&quot;)])
    myeff2 &lt;- setEffect(myeff2, outIso, name = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;outIso&quot;)])
    myeff2 &lt;- includeInteraction(myeff2, recip, gwespFF, parameter = 69, name = &quot;kudonet&quot;)
    (eff1 &lt;- myeff2[myeff2$include, ]$effect1[10])
    (eff2 &lt;- myeff2[myeff2$include, ]$effect2[10])
    myeff2 &lt;- setEffect(myeff2, unspInt, effect1 = eff1, effect2 = eff2, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;unspInt&quot;)])
    myeff2 &lt;- setEffect(myeff2, higher, name = &quot;kudonet&quot;, interaction1 = &quot;time_run&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;higher&quot;)])
    myeff2 &lt;- setEffect(myeff2, egoX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;egoX&quot; &amp; ans2$effects$interaction1==&quot;gender&quot;)])
    myeff2 &lt;- setEffect(myeff2, altX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;altX&quot; &amp; ans2$effects$interaction1==&quot;gender&quot;)])
    myeff2 &lt;- setEffect(myeff2, sameX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;sameX&quot;&amp; ans2$effects$interaction1==&quot;gender&quot;)])
    myeff2 &lt;- setEffect(myeff2, effFrom, name = &quot;time_run&quot;, interaction1 = &quot;time_other&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;effFrom&quot; &amp; ans2$effects$interaction1==&quot;time_other&quot;)])
    myeff2 &lt;- setEffect(myeff2, effFrom, name = &quot;time_run&quot;, interaction1 = &quot;gender&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;effFrom&quot; &amp; ans2$effects$interaction1==&quot;gender&quot;)])
    myeff2 &lt;- setEffect(myeff2, indeg, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;indeg&quot;)])
    myeff2 &lt;- setEffect(myeff2, avAttHigher, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;avAttHigher&quot;)])
    myeff2 &lt;- setEffect(myeff2, avAttLower, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;avAttLower&quot;)])
  }
  
  # fix effects at this value
  myeff$fix[myeff$include==T] &lt;- TRUE 
  myeff2$fix[myeff2$include==T] &lt;- TRUE 
  
  # I also specify models with no social influences, 
  myeff_noinf &lt;- setEffect(myeff, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  myeff_noinf &lt;- setEffect(myeff_noinf, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  myeff_noinf &lt;- setEffect(myeff_noinf, indeg, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  
  myeff2_noinf &lt;- setEffect(myeff2, avAttHigher, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  myeff2_noinf &lt;- setEffect(myeff2_noinf, avAttLower, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  myeff2_noinf &lt;- setEffect(myeff2_noinf, indeg, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  
  # only indegree
  myeff_indeg &lt;- setEffect(myeff_noinf, indeg, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;indeg&quot;)], fix=TRUE)
  
  myeff2_indeg &lt;- setEffect(myeff2_noinf, indeg, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;indeg&quot;)], fix=TRUE)
  
  # only upward assimilation,
  myeff_nolow &lt;- setEffect(myeff_noinf, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttHigher&quot;)], fix=TRUE)
  
  myeff2_nolow &lt;- setEffect(myeff2_noinf, avAttHigher, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;avAttHigher&quot;)], fix=TRUE)
  
  # and only downward assimilation
  myeff_nohigh &lt;- setEffect(myeff_noinf, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttLower&quot;)], fix=TRUE)
  
  myeff2_nohigh &lt;- setEffect(myeff2_noinf, avAttLower, name = &quot;time_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans2$theta[which(ans2$effects$shortName==&quot;avAttLower&quot;)], fix=TRUE)
  
  # set up the simulation settings
  nIter &lt;- 100 # number of iterations
  sim_model &lt;- sienaAlgorithmCreate(
    projname = &#39;simulation&#39;,
    cond = FALSE,
    useStdInits = FALSE, nsub = 0,
    n3 = nIter, 
    seed=242452, # seed for replication
    simOnly = TRUE)
  
  # I will extract the mean running frequency / volume values from the simulation runs
  # make vectors to store means
  meanSimO_freq &lt;- meanSimO_vol &lt;- rep(0, nIter)
  meanSim_noinf_freq &lt;- meanSim_noinf_vol &lt;- rep(0, nIter)
  meanSim_indeg_freq &lt;- meanSim_indeg_vol &lt;- rep(0, nIter)
  meanSim_nolow_freq &lt;- meanSim_nolow_vol &lt;- rep(0, nIter)
  meanSim_nohigh_freq &lt;- meanSim_nohigh_vol &lt;- rep(0, nIter)
  
  # simulation using estimated parameters
  sim_ans &lt;- siena07(sim_model,          # simulation settings
                     data = mydata,      # data
                     effects = myeff,    # defined effects and set parameters
                     returnDeps = TRUE,  # return simulated networks and behaviors
                     returnChains = TRUE,# return sequences of micro-steps
                     batch = TRUE)
  sim_ans2 &lt;- siena07(sim_model,         
                      data = mydata2,      
                      effects = myeff2,    
                      returnDeps = TRUE,  
                      returnChains = TRUE,
                      batch = TRUE)
  
  sim_ans_noinf &lt;- siena07(sim_model,         
                           data = mydata,     
                           effects = myeff_noinf,   
                           returnDeps = TRUE, 
                           returnChains = TRUE,
                           batch = TRUE)
  sim_ans2_noinf &lt;- siena07(sim_model,         
                            data = mydata2,     
                            effects = myeff2_noinf,   
                            returnDeps = TRUE, 
                            returnChains = TRUE,
                            batch = TRUE)
  
  sim_ans_indeg &lt;- siena07(sim_model,         
                           data = mydata,     
                           effects = myeff_indeg,   
                           returnDeps = TRUE, 
                           returnChains = TRUE,
                           batch = TRUE)
  sim_ans2_indeg &lt;- siena07(sim_model,         
                            data = mydata2,     
                            effects = myeff2_indeg,   
                            returnDeps = TRUE, 
                            returnChains = TRUE,
                            batch = TRUE)
  
  sim_ans_nolow &lt;- siena07(sim_model,         
                           data = mydata,     
                           effects = myeff_nolow,   
                           returnDeps = TRUE, 
                           returnChains = TRUE,
                           batch = TRUE)
  sim_ans2_nolow &lt;- siena07(sim_model,         
                            data = mydata2,     
                            effects = myeff2_nolow,   
                            returnDeps = TRUE, 
                            returnChains = TRUE,
                            batch = TRUE)
  
  sim_ans_nohigh &lt;- siena07(sim_model,         
                            data = mydata,     
                            effects = myeff_nohigh,   
                            returnDeps = TRUE, 
                            returnChains = TRUE,
                            batch = TRUE)
  sim_ans2_nohigh &lt;- siena07(sim_model,         
                             data = mydata2,     
                             effects = myeff2_nohigh,   
                             returnDeps = TRUE, 
                             returnChains = TRUE,
                             batch = TRUE)
  
  # extract mean behavior values from simulation runs
  for (i in 1:nIter) {
    meanSimO_freq[i] &lt;- mean(sim_ans$sims[[i]][[1]]$freq_run[[1]])
    meanSimO_vol[i] &lt;- mean(sim_ans2$sims[[i]][[1]]$time_run[[1]])
    meanSim_noinf_freq[i] &lt;- mean(sim_ans_noinf$sims[[i]][[1]]$freq_run[[1]])
    meanSim_noinf_vol[i] &lt;- mean(sim_ans2_noinf$sims[[i]][[1]]$time_run[[1]])
    meanSim_indeg_freq[i] &lt;- mean(sim_ans_indeg$sims[[i]][[1]]$freq_run[[1]])
    meanSim_indeg_vol[i] &lt;- mean(sim_ans2_indeg$sims[[i]][[1]]$time_run[[1]])
    meanSim_nolow_freq[i] &lt;- mean(sim_ans_nolow$sims[[i]][[1]]$freq_run[[1]])
    meanSim_nolow_vol[i] &lt;- mean(sim_ans2_nolow$sims[[i]][[1]]$time_run[[1]])
    meanSim_nohigh_freq[i] &lt;- mean(sim_ans_nohigh$sims[[i]][[1]]$freq_run[[1]])
    meanSim_nohigh_vol[i] &lt;- mean(sim_ans2_nohigh$sims[[i]][[1]]$time_run[[1]])
  }
  #str(sim_ans$sims[[1]]) # numbering is as follows: nIter, group number, DV, period number
  
  # also store observed mean at t2
  meanObs_freq &lt;- mean(club$freq_run[,,2], na.rm = TRUE)
  meanObs_vol &lt;- mean(club$time_run[,,2], na.rm = TRUE)
  
  #  make a layout for the plots
  #dev.off()
  #plot(rnorm(50), rnorm(50))
  l &lt;- layout(matrix(c(1, 2), # sim_vol
                     nrow = 2,
                     ncol = 1,
                     byrow = TRUE))
  #layout.show(l)
  
  # make data for plotting
  plot_data_freq &lt;- rbind(
    data.frame(cond=&quot;Observed&quot;, mean = meanSimO_freq),
    data.frame(cond=&quot;No_inf&quot;, mean = meanSim_noinf_freq),
    data.frame(cond=&quot;Indeg&quot;, mean = meanSim_indeg_freq),
    data.frame(cond=&quot;No_avAttL&quot;, mean = meanSim_nolow_freq),
    data.frame(cond=&quot;No_avAttH&quot;, mean = meanSim_nohigh_freq)
  )
  plot_data_vol &lt;- rbind(
    data.frame(cond=&quot;Observed&quot;, mean = meanSimO_vol),
    data.frame(cond=&quot;No_inf&quot;, mean = meanSim_noinf_vol),
    data.frame(cond=&quot;Indeg&quot;, mean = meanSim_indeg_vol),
    data.frame(cond=&quot;No_avAttL&quot;, mean = meanSim_nolow_vol),
    data.frame(cond=&quot;No_avAttH&quot;, mean = meanSim_nohigh_vol)
  )
  
  # reorder conditions
  plot_data_freq$cond &lt;- factor(plot_data_freq$cond, levels=c(&quot;Observed&quot;, &quot;No_inf&quot;, &quot;Indeg&quot;, &quot;No_avAttL&quot;, &quot;No_avAttH&quot;))
  plot_data_vol$cond &lt;- factor(plot_data_vol$cond, levels=c(&quot;Observed&quot;, &quot;No_inf&quot;, &quot;Indeg&quot;, &quot;No_avAttL&quot;, &quot;No_avAttH&quot;))
  color &lt;- brewer.pal(5, &quot;Set3&quot;) # get colors for boxplots
  {
    boxplot(mean ~ cond, data = plot_data_freq, main = paste(&quot;Simulation results across&quot;, nIter, &quot;iterations&quot;),
            xlab = &quot;Simulation&quot;, ylab = &quot;Average running frequency&quot;, col = color)
    #abline(h=meanObs_freq, col = &quot;brown&quot;) # add the observed mean running at t2
  }
  {
    boxplot(mean ~ cond, data = plot_data_vol, main = paste(&quot;Simulation results across&quot;, nIter, &quot;iterations&quot;),
            xlab = &quot;Simulation model&quot;, ylab = &quot;Average running volume&quot;, col = color)
    #abline(h=meanObs_freq, col = &quot;brown&quot;) # add the observed mean running at t2
  }
  
  # record the plot and put it in the list
  plotL[[c]] &lt;- recordPlot()

}</code></pre>
<!--  ###
  
  # I examine the running frequency changes in greater detail
  n_actors <- club$netsize
  
  Zs5 <- array(NA, dim=c(n_actors,1))
  Zb5 <- array (0, dim=c(nIter,1))
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] <- sim_ans$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] <-colSums(Zs5, na.rm=T)/n_actors
  }
  
  #colMeans(cbind(club$freq_run[,,1:2])) # observed means at t1 and t2
  #colMeans(Zb5)  # average mean simulated behavior value
  #mean( sim_ans$sims[[nIter]][[1]]$freq_run[[1]] )# mean of last simulation run
  
  
  # I plot the mean simulated running frequency over time 
  # extract mean running for all chains, with network change opportunities included
  simChanges <- rep(0, nIter)
  for (i in 1: nIter) {simChanges[i] <- length(sim_ans$chain[[i]][[1]][[1]]) }
  maxChanges <- max(simChanges)
  
  seqs <- matrix(Zb5, nr= nIter, nc=maxChanges+1)  # fill matrix with final mean
  seqs[,1] <- mean(club$freq_run[,,1])   # set t1 mean to observed level
  for (i in 1: nIter) {
    datChain <- t(matrix(unlist(sim_ans$chain[[i]][[1]][[1]]), nc=length(sim_ans$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]=="0") { 
        seqs[i,j+1] <- seqs[i,j]
      }
      if (datChain[j,2]=="1") { 
        seqs[i,j+1] <- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  # plot multiple iterations using loess curves
  micros <- 1:dim(seqs)[2]
  lo1 <- loess(seqs[1,] ~ micros)
  l1 <- predict(lo1, micros)
  
  # set ylim; so it is consistent across plots
  ymin <- plyr::round_any(min(seqs, na.rm=TRUE), .5, f=floor)
  ymax <- plyr::round_any(max(seqs, na.rm=TRUE), .5, f=ceiling)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type="l", 
       ylab='Average running frequency', xlab='Micro-step', col='white',
       main='Mean running over time:
     full model')   
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # do the same for the model with no peer influence whatsoever. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] <- sim_ans_noinf$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] <-colSums(Zs5, na.rm=T)/n_actors
  }
  for (i in 1: nIter) {
    datChain <- t(matrix(unlist(sim_ans_noinf$chain[[i]][[1]][[1]]), nc=length(sim_ans_noinf$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]=="0") { 
        seqs[i,j+1] <- seqs[i,j]
      }
      if (datChain[j,2]=="1") { 
        seqs[i,j+1] <- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros <- 1:dim(seqs)[2]
  lo1 <- loess(seqs[1,] ~ micros)
  l1 <- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type="l", 
       ylab='Average running frequency', xlab='Micro-step', col='white',
       main='Mean running over time:
     no influence') 
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # no downward assimilation. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] <- sim_ans_nolow$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] <-colSums(Zs5, na.rm=T)/n_actors
  }
  
  for (i in 1: nIter) {
    datChain <- t(matrix(unlist(sim_ans_nolow$chain[[i]][[1]][[1]]), nc=length(sim_ans_nolow$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]=="0") { 
        seqs[i,j+1] <- seqs[i,j]
      }
      if (datChain[j,2]=="1") { 
        seqs[i,j+1] <- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros <- 1:dim(seqs)[2]
  lo1 <- loess(seqs[1,] ~ micros)
  l1 <- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type="l", 
       ylab='Average running frequency', xlab='Micro-step', col='white',
       main='Mean running over time:
     no avAttLower')    
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # no upward assimilation. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] <- sim_ans_nohigh$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] <-colSums(Zs5, na.rm=T)/n_actors
  }
  
  for (i in 1: nIter) {
    datChain <- t(matrix(unlist(sim_ans_nohigh$chain[[i]][[1]][[1]]), nc=length(sim_ans_nohigh$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]=="0") { 
        seqs[i,j+1] <- seqs[i,j]
      }
      if (datChain[j,2]=="1") { 
        seqs[i,j+1] <- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros <- 1:dim(seqs)[2]
  lo1 <- loess(seqs[1,] ~ micros)
  l1 <- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type="l", 
       ylab='Average running frequency', xlab='Micro-step', col='white',
       main='Mean running over time:
     no avAttHigher')   
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  #save the plot to the list
  plotL[[c]] <- recordPlot()

}


-->
<p><br></p>
</div>
<div id="plots" class="section level1 tabset tabset-fade">
<h1 class="tabset tabset-fade">Plots</h1>
<div id="club-1" class="section level2">
<h2>club 1</h2>
<p><img src="abm_plot_club1.png" /></p>
</div>
<div id="club-2" class="section level2">
<h2>club 2</h2>
<p><img src="abm_plot_club2.png" /></p>
</div>
<div id="club-3" class="section level2">
<h2>club 3</h2>
<p><img src="abm_plot_club3.png" /></p>
</div>
<div id="club-4" class="section level2">
<h2>club 4</h2>
<p><img src="abm_plot_club4.png" /></p>
</div>
<div id="club-5" class="section level2">
<h2>club 5</h2>
<p><img src="abm_plot_club5.png" /></p>
</div>
</div>
<div id="section" class="section level1 unnumbered">
<h1 class="unnumbered"></h1>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlNBT00gYXMgQUJNIg0KZGF0ZTogIkxhc3QgY29tcGlsZWQgb24gYHIgZm9ybWF0KFN5cy50aW1lKCksICclQiwgJVknKWAiDQpiaWJsaW9ncmFwaHk6IHJlZmVyZW5jZXMuYmliDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgY3NzOiB0d2Vha3MuY3NzDQogICAgdG9jOiB0cnVlDQogICAgdG9jX2Zsb2F0OiB0cnVlDQogICAgY29sbGFwc2VkOiBmYWxzZQ0KICAgIG51bWJlcl9zZWN0aW9uczogZmFsc2UNCiAgICB0b2NfZGVwdGg6IDENCiAgICBjb2RlX2ZvbGRpbmc6IHNob3cNCiAgICBjb2RlX2Rvd25sb2FkOiB5ZXMNCi0tLQ0KICANCmBgYHtyLCBnbG9iYWxzZXR0aW5ncywgZWNobz1GQUxTRSwgd2FybmluZz1GQUxTRSwgcmVzdWx0cz0naGlkZSd9DQpsaWJyYXJ5KGtuaXRyKQ0KbGlicmFyeShSU2llbmEpDQpsaWJyYXJ5KGdncGxvdDIpDQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpDQpvcHRzX2NodW5rJHNldCh0aWR5Lm9wdHM9bGlzdCh3aWR0aC5jdXRvZmY9MTAwKSx0aWR5PVRSVUUsIHdhcm5pbmcgPSBGQUxTRSwgbWVzc2FnZSA9IEZBTFNFLGNvbW1lbnQgPSAiIz4iLCBjYWNoZT1UUlVFLCBjbGFzcy5zb3VyY2U9YygidGVzdCIpLCBjbGFzcy5vdXRwdXQ9YygidGVzdDIiKSkNCm9wdGlvbnMod2lkdGggPSAxMDApDQpyZ2w6OnNldHVwS25pdHIoKQ0KDQpjb2xvcml6ZSA8LSBmdW5jdGlvbih4LCBjb2xvcikge3NwcmludGYoIjxzcGFuIHN0eWxlPSdjb2xvcjogJXM7Jz4lczwvc3Bhbj4iLCBjb2xvciwgeCkgfQ0KDQpgYGANCg0KYGBge3Iga2xpcHB5LCBlY2hvPUZBTFNFLCBpbmNsdWRlPVRSVUV9DQprbGlwcHk6OmtsaXBweShwb3NpdGlvbiA9IGMoJ3RvcCcsICdyaWdodCcpKQ0KI2tsaXBweTo6a2xpcHB5KGNvbG9yID0gJ2RhcmtyZWQnKQ0KI2tsaXBweTo6a2xpcHB5KHRvb2x0aXBfbWVzc2FnZSA9ICdDbGljayB0byBjb3B5JywgdG9vbHRpcF9zdWNjZXNzID0gJ0RvbmUnKQ0KYGBgDQoNCg0KDQotLS0NCiAgDQpBaW06IHRvIGV4cGxvcmUgaG93IGNvbnNlcXVlbnRpYWwgaW5mbHVlbmNlIGVmZmVjdHMgYXJlIGZvciB0aGUgcnVubmluZyBiZWhhdmlvciAoaGVyZSwgZnJlcXVlbmN5KSBhY3Jvc3MgY2x1YnMuDQoNCkkgcmVkdWNlZCB0aGUgZGF0YSB0byBvbmx5IHR3byB0aW1lLXBvaW50cy4gSW5pdGlhbCBlZmZlY3QgdmFsdWVzIGFyZSBzZXQgYmFzZWQgb24gdGhlIGVzdGltYXRlZCBtb2RlbCBwYXJhbWV0ZXJzIG9mIHRhYmxlcyAyIGFuZCAzIG9mIHRoZSBtYW51c2NyaXB0Lg0KDQpJIHNwZWNpZnkgYWRkaXRpb25hbCBtb2RlbHM6IDEpIHdpdGggbm8gcGVlciBpbmZsdWVuY2UgZWZmZWN0cyB3aGF0c29ldmVyOyAyKSB3aXRoIG9ubHkgaW5kZWdyZWUgZWZmZWN0IG9uIGJlaGF2aW9yOyAzKSB3aXRoIG9ubHkgdXB3YXJkIGFzc2ltaWxhdGlvbiAoYXZBdHRIaWdoZXIpOyA0KSB3aXRoIG9ubHkgZG93bndhcmQgYXNzaW1pbGF0aW9uIChhdkF0dExvd2VyKS4NCg0KDQpgciBjb2xvcml6ZSgib25seSAxMDAgc2ltdWxhdGlvbnMgd2VyZSBydW4sIGJ1dCB0aGlzIGNhbiBiZSBhZGp1c3RlZCBpbiB0aGUgc2NyaXB0ISIsICJyZWQiKWANCg0KLS0tLQ0KDQo8YnI+DQoNCiMgR2V0dGluZyBzdGFydGVkDQoNCiMjIGNsZWFuIHVwDQoNCmBgYHtyLCBhdHRyLm91dHB1dD0nc3R5bGU9Im1heC1oZWlnaHQ6IDIwMHB4OyInfQ0KDQpybSAobGlzdCA9IGxzKCApKQ0KI2djKCkNCmBgYA0KDQo8YnI+DQoNCiMjIGdlbmVyYWwgY3VzdG9tIGZ1bmN0aW9ucw0KDQotIGBmcGFja2FnZS5jaGVja2A6IENoZWNrIGlmIHBhY2thZ2VzIGFyZSBpbnN0YWxsZWQgKGFuZCBpbnN0YWxsIGlmIG5vdCkgaW4gUiAoW3NvdXJjZV0oaHR0cHM6Ly92YmFsaWdhLmdpdGh1Yi5pby92ZXJpZnktdGhhdC1yLXBhY2thZ2VzLWFyZS1pbnN0YWxsZWQtYW5kLWxvYWRlZC8pKQ0KLSBgZmxvYWQuUmA6IGZ1bmN0aW9uIHRvIGxvYWQgUi1vYmplY3RzIHVuZGVyIG5ldyBuYW1lcy4NCg0KYGBge3IsIHJlc3VsdHM9J2hpZGUnLCBldmFsPUZBTFNFfQ0KDQpmcGFja2FnZS5jaGVjayA8LSBmdW5jdGlvbihwYWNrYWdlcykgew0KICAgIGxhcHBseShwYWNrYWdlcywgRlVOID0gZnVuY3Rpb24oeCkgew0KICAgICAgICBpZiAoIXJlcXVpcmUoeCwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKSkgew0KICAgICAgICAgICAgaW5zdGFsbC5wYWNrYWdlcyh4LCBkZXBlbmRlbmNpZXMgPSBUUlVFKQ0KICAgICAgICAgICAgbGlicmFyeSh4LCBjaGFyYWN0ZXIub25seSA9IFRSVUUpDQogICAgICAgIH0NCiAgICB9KQ0KfQ0KDQpmbG9hZC5SICA8LSBmdW5jdGlvbihmaWxlTmFtZSl7DQogIGxvYWQoZmlsZU5hbWUpDQogIGdldChscygpW2xzKCkgIT0gImZpbGVOYW1lIl0pDQp9DQoNCmBgYA0KDQoNCiMjIG5lY2Vzc2FyeSBwYWNrYWdlcw0KDQotIGBSU2llbmFgOiBTSUVOQSBhcyBBQk0NCi0gYHNuYWANCi0gYGxhdHRpY2VgOiBmb3IgcGxvdHRpbmcNCi0gYFJDb2xvckJyZXdlcmA6IGNvbG9yIHBhbGV0dGVzDQoNCg0KYGBge3IgcGFja2FnZXMsIGV2YWw9RkFMU0V9DQoNCnBhY2thZ2VzID0gYygiUlNpZW5hIiwgInNuYSIsICJsYXR0aWNlIiwgIlJDb2xvckJyZXdlciIpDQoNCmZwYWNrYWdlLmNoZWNrKHBhY2thZ2VzKQ0KYGBgDQoNCjxicj4NCg0KIyMgbG9hZCBjbHViIGRhdGENCg0KDQpMb2FkIHRoZSBjbHViIGxpc3QsIHRvIHNldCB1cCBvdXIgc3RhcnRpbmcgbmV0d29ya3MNCmBgYHtyIGV2YWw9Rn0NCmxvYWQoImNsdWJkYXRhLlJEYXRhIikNCmBgYA0KDQoNCjxicj4NCg0KVGhlIGZvbGxvd2luZyBzY3JpcHRzIG1ha2VzIGZvciBhbGwgY2x1YnMgYm94cGxvdHMgaWxsdXN0cmF0aW5nIGhvdyBhdmVyYWdlIHJ1bm5pbmcgYmVoYXZpb3IgdmFsdWVzIGRpZmZlciBhY3Jvc3MgZGlmZmVyZW50IHNpbXVsYXRpb24gbW9kZWxzLg0KDQoqKk1vZGVscyoqOg0KDQotIG1vZGVsIDUNCi0gbm9faW5mDQotIG9ubHkgaW5kZWdyZWUNCi0gb25seSBhdkF0dExvd2VyDQotIG9ubHkgYXZBdHRIaWdoZXINCg0KDQojICBzaW11bGF0aW9uIG1vZGVscw0KYGBge3IsIGV2YWw9Rn0NCnBsb3RMIDwtIGxpc3QoKSAjIGxpc3QgdG8gc3RvcmUgcGxvdHMgaW4NCg0KZm9yIChjIGluIDE6bGVuZ3RoKGNsdWJkYXRhKSkgew0KDQogICMgcGljayBjbHViDQoNCiAgY2x1YiA8LSBjbHViZGF0YVtbY11dDQogIA0KICAjIHdlIHJlZHVjZSB0aGUgZGF0YSB0byBvbmx5IHR3byB0aW1lIHBvaW50cw0KICBrdWRvbmV0IDwtIHNpZW5hRGVwZW5kZW50KGNsdWIka3Vkb1ssLDE6Ml0sIGFsbG93T25seSA9IEZBTFNFKQ0KICBmcmVxX3J1biA8LSBzaWVuYURlcGVuZGVudChjbHViJGZyZXFfcnVuWywsMToyXSwgdHlwZSA9ICJiZWhhdmlvciIsIGFsbG93T25seSA9IEZBTFNFKSANCiAgdGltZV9ydW4gPC0gc2llbmFEZXBlbmRlbnQoY2x1YiR0aW1lX3J1blssLDE6Ml0sIHR5cGUgPSAiYmVoYXZpb3IiLCBhbGxvd09ubHkgPSBGQUxTRSkgDQogIA0KICAjIGNvdmFyaWF0ZXMNCiAgIyBjaGFuZ2luZyBjb3ZhcmlhdGVzIG5vdCBwb3NzaWJsZSB3aXRoIG9ubHkgMiB3YXZlcywgc28gd2UgbWFrZSBvdGhlciBhY3Rpdml0eSBhIGNvbnN0YW50DQogIGZyZXFfb3RoZXIgPC0gY29Db3ZhcihjbHViJGZyZXFfb3RoZXJbLCAsMV0pDQogIHRpbWVfb3RoZXIgPC0gY29Db3ZhcihjbHViJHRpbWVfb3RoZXJbLCAsMV0pDQogIGdlbmRlciA8LSBjb0NvdmFyKGlmZWxzZShjbHViJG1hbGUgPT0gMSwgMSwgMikpDQogIA0KICAjIGNyZWF0ZSBhIFJTaWVuYSBkYXRhIG9iamVjdCBmb3IgYm90aCBtb2RlbHM6IGZyZXF1ZW5jeSBhbmQgdm9sdW1lDQogIG15ZGF0YSA8LSBzaWVuYURhdGFDcmVhdGUoa3Vkb25ldCwgZnJlcV9ydW4sIGZyZXFfb3RoZXIsIGdlbmRlcikNCiAgbXlkYXRhMjwtIHNpZW5hRGF0YUNyZWF0ZShrdWRvbmV0LCB0aW1lX3J1biwgdGltZV9vdGhlciwgZ2VuZGVyKQ0KICANCiAgIyBsb2FkIGluIHRoZSBzaWVuYUZpdCBvYmplY3QgbGlzdCwgY29udGFpbmluZyBlc3RpbWF0ZWQgcGFyYW1ldGVycw0KICAjIGZvciB0aGUgZnJlcXVlbmN5IGFuZCB2b2x1bWUgbW9kZWwNCiAgbG9hZChwYXN0ZTAoInRlc3Qvc2llbmFGaXQvc2llbmFGaXRfY2x1YiIsIGMsICIuUkRhdGEiKSkgIyBmcmVxLg0KICBhbnMgPC0gc2llbmFGaXRbWzVdXSAjIGdldCBvYmplY3QgZm9yIG1haW4gbW9kZWwgKG01KQ0KICBsb2FkKHBhc3RlMCgidGVzdC9zaWVuYUZpdC9kdXJhdGlvbi9zaWVuYUZpdF9jbHViIiwgYywgIi5SRGF0YSIpKSAjIHZvbC4NCiAgYW5zMiA8LSBzaWVuYUZpdFtbNV1dDQogIA0KICAjIG1ha2UgZWZmZWN0cyBvYmplY3QNCiAgbXllZmYgPC0gZ2V0RWZmZWN0cyhteWRhdGEpDQogIG15ZWZmMiA8LSBnZXRFZmZlY3RzKG15ZGF0YTIpDQogICMgc2V0IGluaXRpYWwgdmFsdWVzIG9mIGJhc2ljIGVmZmVjdHMgZm9yIHNpbXVsYXRpb25zIGJhc2VkIG9uIGVzdGltYXRlZCBtb2RlbA0KICBteWVmZiRpbml0aWFsVmFsdWVbbXllZmYkaW5jbHVkZT09VF0gPC0gYW5zJHRoZXRhW2MoMSwxMiwxMywyOCwzOSw0MCldDQogIG15ZWZmMiRpbml0aWFsVmFsdWVbbXllZmYyJGluY2x1ZGU9PVRdIDwtIGFuczIkdGhldGFbYygxLDEyLDEzLDI4LDM5LDQwKV0NCiAgDQogICMgaW5jbHVkZSBleHRyYSBlZmZlY3RzIGFuZCBzZXQgaW5pdGlhbCB2YWx1ZQ0KICAjIGZyZXF1ZW5jeSBtb2RlbA0KICB7DQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBnd2VzcEZGLCBuYW1lID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iZ3dlc3BGRiIpXSkNCiAgICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIG91dEFjdFNxcnQsIG5hbWUgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJvdXRBY3RTcXJ0IildKQ0KICAgIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgaW5Qb3BTcXJ0LCBuYW1lID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5Qb3BTcXJ0IildKQ0KICAgIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgb3V0UG9wU3FydCwgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09Im91dFBvcFNxcnQiKV0pDQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCByZWNpQWN0LCBuYW1lID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0icmVjaUFjdCIpXSkNCiAgICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIG91dElzbywgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09Im91dElzbyIpXSkNCiAgICBteWVmZiA8LSBpbmNsdWRlSW50ZXJhY3Rpb24obXllZmYsIHJlY2lwLCBnd2VzcEZGLCBwYXJhbWV0ZXIgPSA2OSwgbmFtZSA9ICJrdWRvbmV0IikNCiAgICAoZWZmMSA8LSBteWVmZltteWVmZiRpbmNsdWRlLCBdJGVmZmVjdDFbMTBdKQ0KICAgIChlZmYyIDwtIG15ZWZmW215ZWZmJGluY2x1ZGUsIF0kZWZmZWN0MlsxMF0pDQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCB1bnNwSW50LCBlZmZlY3QxID0gZWZmMSwgZWZmZWN0MiA9IGVmZjIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJ1bnNwSW50IildKQ0KICAgIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgaGlnaGVyLCBuYW1lID0gImt1ZG9uZXQiLCBpbnRlcmFjdGlvbjEgPSAiZnJlcV9ydW4iLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaGlnaGVyIildKQ0KICAgIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgZWdvWCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJlZ29YIiAmIGFucyRlZmZlY3RzJGludGVyYWN0aW9uMT09ImdlbmRlciIpXSkNCiAgICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGFsdFgsIG5hbWUgPSAia3Vkb25ldCIsIGludGVyYWN0aW9uMSA9ICJnZW5kZXIiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iYWx0WCIgJiBhbnMkZWZmZWN0cyRpbnRlcmFjdGlvbjE9PSJnZW5kZXIiKV0pDQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBzYW1lWCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJzYW1lWCImIGFucyRlZmZlY3RzJGludGVyYWN0aW9uMT09ImdlbmRlciIpXSkNCiAgICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGVmZkZyb20sIG5hbWUgPSAiZnJlcV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAiZnJlcV9vdGhlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJlZmZGcm9tIiAmIGFucyRlZmZlY3RzJGludGVyYWN0aW9uMT09ImZyZXFfb3RoZXIiKV0pDQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBlZmZGcm9tLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJlZmZGcm9tIiAmIGFucyRlZmZlY3RzJGludGVyYWN0aW9uMT09ImdlbmRlciIpXSkNCiAgICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGluZGVnLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5kZWciKV0pDQogICAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09ImF2QXR0SGlnaGVyIildKQ0KICAgIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgYXZBdHRMb3dlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09ImF2QXR0TG93ZXIiKV0pDQogIH0NCiAgDQogICMgdm9sdW1lIG1vZGVsDQogIHsNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgZ3dlc3BGRiwgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0iZ3dlc3BGRiIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgb3V0QWN0U3FydCwgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0ib3V0QWN0U3FydCIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgaW5Qb3BTcXJ0LCBuYW1lID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJpblBvcFNxcnQiKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIG91dFBvcFNxcnQsIG5hbWUgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09Im91dFBvcFNxcnQiKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIHJlY2lBY3QsIG5hbWUgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09InJlY2lBY3QiKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIG91dElzbywgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0ib3V0SXNvIildKQ0KICAgIG15ZWZmMiA8LSBpbmNsdWRlSW50ZXJhY3Rpb24obXllZmYyLCByZWNpcCwgZ3dlc3BGRiwgcGFyYW1ldGVyID0gNjksIG5hbWUgPSAia3Vkb25ldCIpDQogICAgKGVmZjEgPC0gbXllZmYyW215ZWZmMiRpbmNsdWRlLCBdJGVmZmVjdDFbMTBdKQ0KICAgIChlZmYyIDwtIG15ZWZmMltteWVmZjIkaW5jbHVkZSwgXSRlZmZlY3QyWzEwXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgdW5zcEludCwgZWZmZWN0MSA9IGVmZjEsIGVmZmVjdDIgPSBlZmYyLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJ1bnNwSW50IildKQ0KICAgIG15ZWZmMiA8LSBzZXRFZmZlY3QobXllZmYyLCBoaWdoZXIsIG5hbWUgPSAia3Vkb25ldCIsIGludGVyYWN0aW9uMSA9ICJ0aW1lX3J1biIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09ImhpZ2hlciIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgZWdvWCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09ImVnb1giICYgYW5zMiRlZmZlY3RzJGludGVyYWN0aW9uMT09ImdlbmRlciIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgYWx0WCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09ImFsdFgiICYgYW5zMiRlZmZlY3RzJGludGVyYWN0aW9uMT09ImdlbmRlciIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgc2FtZVgsIG5hbWUgPSAia3Vkb25ldCIsIGludGVyYWN0aW9uMSA9ICJnZW5kZXIiLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJzYW1lWCImIGFuczIkZWZmZWN0cyRpbnRlcmFjdGlvbjE9PSJnZW5kZXIiKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIGVmZkZyb20sIG5hbWUgPSAidGltZV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAidGltZV9vdGhlciIsIGluaXRpYWxWYWx1ZSA9IGFuczIkdGhldGFbd2hpY2goYW5zMiRlZmZlY3RzJHNob3J0TmFtZT09ImVmZkZyb20iICYgYW5zMiRlZmZlY3RzJGludGVyYWN0aW9uMT09InRpbWVfb3RoZXIiKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIGVmZkZyb20sIG5hbWUgPSAidGltZV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAiZ2VuZGVyIiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0iZWZmRnJvbSIgJiBhbnMyJGVmZmVjdHMkaW50ZXJhY3Rpb24xPT0iZ2VuZGVyIildKQ0KICAgIG15ZWZmMiA8LSBzZXRFZmZlY3QobXllZmYyLCBpbmRlZywgbmFtZSA9ICJ0aW1lX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5kZWciKV0pDQogICAgbXllZmYyIDwtIHNldEVmZmVjdChteWVmZjIsIGF2QXR0SGlnaGVyLCBuYW1lID0gInRpbWVfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJhdkF0dEhpZ2hlciIpXSkNCiAgICBteWVmZjIgPC0gc2V0RWZmZWN0KG15ZWZmMiwgYXZBdHRMb3dlciwgbmFtZSA9ICJ0aW1lX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0iYXZBdHRMb3dlciIpXSkNCiAgfQ0KICANCiAgIyBmaXggZWZmZWN0cyBhdCB0aGlzIHZhbHVlDQogIG15ZWZmJGZpeFtteWVmZiRpbmNsdWRlPT1UXSA8LSBUUlVFIA0KICBteWVmZjIkZml4W215ZWZmMiRpbmNsdWRlPT1UXSA8LSBUUlVFIA0KICANCiAgIyBJIGFsc28gc3BlY2lmeSBtb2RlbHMgd2l0aCBubyBzb2NpYWwgaW5mbHVlbmNlcywgDQogIG15ZWZmX25vaW5mIDwtIHNldEVmZmVjdChteWVmZiwgYXZBdHRIaWdoZXIsIG5hbWUgPSAiZnJlcV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IDAsIGZpeCA9IFRSVUUpDQogIG15ZWZmX25vaW5mIDwtIHNldEVmZmVjdChteWVmZl9ub2luZiwgYXZBdHRMb3dlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgbXllZmZfbm9pbmYgPC0gc2V0RWZmZWN0KG15ZWZmX25vaW5mLCBpbmRlZywgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgDQogIG15ZWZmMl9ub2luZiA8LSBzZXRFZmZlY3QobXllZmYyLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJ0aW1lX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgbXllZmYyX25vaW5mIDwtIHNldEVmZmVjdChteWVmZjJfbm9pbmYsIGF2QXR0TG93ZXIsIG5hbWUgPSAidGltZV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IDAsIGZpeCA9IFRSVUUpDQogIG15ZWZmMl9ub2luZiA8LSBzZXRFZmZlY3QobXllZmYyX25vaW5mLCBpbmRlZywgbmFtZSA9ICJ0aW1lX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgDQogICMgb25seSBpbmRlZ3JlZQ0KICBteWVmZl9pbmRlZyA8LSBzZXRFZmZlY3QobXllZmZfbm9pbmYsIGluZGVnLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5kZWciKV0sIGZpeD1UUlVFKQ0KICANCiAgbXllZmYyX2luZGVnIDwtIHNldEVmZmVjdChteWVmZjJfbm9pbmYsIGluZGVnLCBuYW1lID0gInRpbWVfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJpbmRlZyIpXSwgZml4PVRSVUUpDQogIA0KICAjIG9ubHkgdXB3YXJkIGFzc2ltaWxhdGlvbiwNCiAgbXllZmZfbm9sb3cgPC0gc2V0RWZmZWN0KG15ZWZmX25vaW5mLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09ImF2QXR0SGlnaGVyIildLCBmaXg9VFJVRSkNCiAgDQogIG15ZWZmMl9ub2xvdyA8LSBzZXRFZmZlY3QobXllZmYyX25vaW5mLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJ0aW1lX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zMiR0aGV0YVt3aGljaChhbnMyJGVmZmVjdHMkc2hvcnROYW1lPT0iYXZBdHRIaWdoZXIiKV0sIGZpeD1UUlVFKQ0KICANCiAgIyBhbmQgb25seSBkb3dud2FyZCBhc3NpbWlsYXRpb24NCiAgbXllZmZfbm9oaWdoIDwtIHNldEVmZmVjdChteWVmZl9ub2luZiwgYXZBdHRMb3dlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09ImF2QXR0TG93ZXIiKV0sIGZpeD1UUlVFKQ0KICANCiAgbXllZmYyX25vaGlnaCA8LSBzZXRFZmZlY3QobXllZmYyX25vaW5mLCBhdkF0dExvd2VyLCBuYW1lID0gInRpbWVfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMyJHRoZXRhW3doaWNoKGFuczIkZWZmZWN0cyRzaG9ydE5hbWU9PSJhdkF0dExvd2VyIildLCBmaXg9VFJVRSkNCiAgDQogICMgc2V0IHVwIHRoZSBzaW11bGF0aW9uIHNldHRpbmdzDQogIG5JdGVyIDwtIDEwMCAjIG51bWJlciBvZiBpdGVyYXRpb25zDQogIHNpbV9tb2RlbCA8LSBzaWVuYUFsZ29yaXRobUNyZWF0ZSgNCiAgICBwcm9qbmFtZSA9ICdzaW11bGF0aW9uJywNCiAgICBjb25kID0gRkFMU0UsDQogICAgdXNlU3RkSW5pdHMgPSBGQUxTRSwgbnN1YiA9IDAsDQogICAgbjMgPSBuSXRlciwgDQogICAgc2VlZD0yNDI0NTIsICMgc2VlZCBmb3IgcmVwbGljYXRpb24NCiAgICBzaW1Pbmx5ID0gVFJVRSkNCiAgDQogICMgSSB3aWxsIGV4dHJhY3QgdGhlIG1lYW4gcnVubmluZyBmcmVxdWVuY3kgLyB2b2x1bWUgdmFsdWVzIGZyb20gdGhlIHNpbXVsYXRpb24gcnVucw0KICAjIG1ha2UgdmVjdG9ycyB0byBzdG9yZSBtZWFucw0KICBtZWFuU2ltT19mcmVxIDwtIG1lYW5TaW1PX3ZvbCA8LSByZXAoMCwgbkl0ZXIpDQogIG1lYW5TaW1fbm9pbmZfZnJlcSA8LSBtZWFuU2ltX25vaW5mX3ZvbCA8LSByZXAoMCwgbkl0ZXIpDQogIG1lYW5TaW1faW5kZWdfZnJlcSA8LSBtZWFuU2ltX2luZGVnX3ZvbCA8LSByZXAoMCwgbkl0ZXIpDQogIG1lYW5TaW1fbm9sb3dfZnJlcSA8LSBtZWFuU2ltX25vbG93X3ZvbCA8LSByZXAoMCwgbkl0ZXIpDQogIG1lYW5TaW1fbm9oaWdoX2ZyZXEgPC0gbWVhblNpbV9ub2hpZ2hfdm9sIDwtIHJlcCgwLCBuSXRlcikNCiAgDQogICMgc2ltdWxhdGlvbiB1c2luZyBlc3RpbWF0ZWQgcGFyYW1ldGVycw0KICBzaW1fYW5zIDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgICAjIHNpbXVsYXRpb24gc2V0dGluZ3MNCiAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBteWRhdGEsICAgICAgIyBkYXRhDQogICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmYsICAgICMgZGVmaW5lZCBlZmZlY3RzIGFuZCBzZXQgcGFyYW1ldGVycw0KICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsICAjIHJldHVybiBzaW11bGF0ZWQgbmV0d29ya3MgYW5kIGJlaGF2aW9ycw0KICAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ2hhaW5zID0gVFJVRSwjIHJldHVybiBzZXF1ZW5jZXMgb2YgbWljcm8tc3RlcHMNCiAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgc2ltX2FuczIgPC0gc2llbmEwNyhzaW1fbW9kZWwsICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG15ZGF0YTIsICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgZWZmZWN0cyA9IG15ZWZmMiwgICAgDQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsICANCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgDQogIHNpbV9hbnNfbm9pbmYgPC0gc2llbmEwNyhzaW1fbW9kZWwsICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gbXlkYXRhLCAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmZfbm9pbmYsICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5EZXBzID0gVFJVRSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBUUlVFKQ0KICBzaW1fYW5zMl9ub2luZiA8LSBzaWVuYTA3KHNpbV9tb2RlbCwgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gbXlkYXRhMiwgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVmZmVjdHMgPSBteWVmZjJfbm9pbmYsICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkNoYWlucyA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBUUlVFKQ0KICANCiAgc2ltX2Fuc19pbmRlZyA8LSBzaWVuYTA3KHNpbV9tb2RlbCwgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBteWRhdGEsICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGVmZmVjdHMgPSBteWVmZl9pbmRlZywgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkRlcHMgPSBUUlVFLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkNoYWlucyA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IFRSVUUpDQogIHNpbV9hbnMyX2luZGVnIDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBteWRhdGEyLCAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0cyA9IG15ZWZmMl9pbmRlZywgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5EZXBzID0gVFJVRSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ2hhaW5zID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IFRSVUUpDQogIA0KICBzaW1fYW5zX25vbG93IDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG15ZGF0YSwgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0cyA9IG15ZWZmX25vbG93LCAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ2hhaW5zID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgc2ltX2FuczJfbm9sb3cgPC0gc2llbmEwNyhzaW1fbW9kZWwsICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG15ZGF0YTIsICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmYyX25vbG93LCAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkRlcHMgPSBUUlVFLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgDQogIHNpbV9hbnNfbm9oaWdoIDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBteWRhdGEsICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmZfbm9oaWdoLCAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkRlcHMgPSBUUlVFLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgc2ltX2FuczJfbm9oaWdoIDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gbXlkYXRhMiwgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmYyX25vaGlnaCwgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IFRSVUUpDQogIA0KICAjIGV4dHJhY3QgbWVhbiBiZWhhdmlvciB2YWx1ZXMgZnJvbSBzaW11bGF0aW9uIHJ1bnMNCiAgZm9yIChpIGluIDE6bkl0ZXIpIHsNCiAgICBtZWFuU2ltT19mcmVxW2ldIDwtIG1lYW4oc2ltX2FucyRzaW1zW1tpXV1bWzFdXSRmcmVxX3J1bltbMV1dKQ0KICAgIG1lYW5TaW1PX3ZvbFtpXSA8LSBtZWFuKHNpbV9hbnMyJHNpbXNbW2ldXVtbMV1dJHRpbWVfcnVuW1sxXV0pDQogICAgbWVhblNpbV9ub2luZl9mcmVxW2ldIDwtIG1lYW4oc2ltX2Fuc19ub2luZiRzaW1zW1tpXV1bWzFdXSRmcmVxX3J1bltbMV1dKQ0KICAgIG1lYW5TaW1fbm9pbmZfdm9sW2ldIDwtIG1lYW4oc2ltX2FuczJfbm9pbmYkc2ltc1tbaV1dW1sxXV0kdGltZV9ydW5bWzFdXSkNCiAgICBtZWFuU2ltX2luZGVnX2ZyZXFbaV0gPC0gbWVhbihzaW1fYW5zX2luZGVnJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV0pDQogICAgbWVhblNpbV9pbmRlZ192b2xbaV0gPC0gbWVhbihzaW1fYW5zMl9pbmRlZyRzaW1zW1tpXV1bWzFdXSR0aW1lX3J1bltbMV1dKQ0KICAgIG1lYW5TaW1fbm9sb3dfZnJlcVtpXSA8LSBtZWFuKHNpbV9hbnNfbm9sb3ckc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXSkNCiAgICBtZWFuU2ltX25vbG93X3ZvbFtpXSA8LSBtZWFuKHNpbV9hbnMyX25vbG93JHNpbXNbW2ldXVtbMV1dJHRpbWVfcnVuW1sxXV0pDQogICAgbWVhblNpbV9ub2hpZ2hfZnJlcVtpXSA8LSBtZWFuKHNpbV9hbnNfbm9oaWdoJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV0pDQogICAgbWVhblNpbV9ub2hpZ2hfdm9sW2ldIDwtIG1lYW4oc2ltX2FuczJfbm9oaWdoJHNpbXNbW2ldXVtbMV1dJHRpbWVfcnVuW1sxXV0pDQogIH0NCiAgI3N0cihzaW1fYW5zJHNpbXNbWzFdXSkgIyBudW1iZXJpbmcgaXMgYXMgZm9sbG93czogbkl0ZXIsIGdyb3VwIG51bWJlciwgRFYsIHBlcmlvZCBudW1iZXINCiAgDQogICMgYWxzbyBzdG9yZSBvYnNlcnZlZCBtZWFuIGF0IHQyDQogIG1lYW5PYnNfZnJlcSA8LSBtZWFuKGNsdWIkZnJlcV9ydW5bLCwyXSwgbmEucm0gPSBUUlVFKQ0KICBtZWFuT2JzX3ZvbCA8LSBtZWFuKGNsdWIkdGltZV9ydW5bLCwyXSwgbmEucm0gPSBUUlVFKQ0KICANCiAgIyAgbWFrZSBhIGxheW91dCBmb3IgdGhlIHBsb3RzDQogICNkZXYub2ZmKCkNCiAgI3Bsb3Qocm5vcm0oNTApLCBybm9ybSg1MCkpDQogIGwgPC0gbGF5b3V0KG1hdHJpeChjKDEsIDIpLCAjIHNpbV92b2wNCiAgICAgICAgICAgICAgICAgICAgIG5yb3cgPSAyLA0KICAgICAgICAgICAgICAgICAgICAgbmNvbCA9IDEsDQogICAgICAgICAgICAgICAgICAgICBieXJvdyA9IFRSVUUpKQ0KICAjbGF5b3V0LnNob3cobCkNCiAgDQogICMgbWFrZSBkYXRhIGZvciBwbG90dGluZw0KICBwbG90X2RhdGFfZnJlcSA8LSByYmluZCgNCiAgICBkYXRhLmZyYW1lKGNvbmQ9Ik9ic2VydmVkIiwgbWVhbiA9IG1lYW5TaW1PX2ZyZXEpLA0KICAgIGRhdGEuZnJhbWUoY29uZD0iTm9faW5mIiwgbWVhbiA9IG1lYW5TaW1fbm9pbmZfZnJlcSksDQogICAgZGF0YS5mcmFtZShjb25kPSJJbmRlZyIsIG1lYW4gPSBtZWFuU2ltX2luZGVnX2ZyZXEpLA0KICAgIGRhdGEuZnJhbWUoY29uZD0iTm9fYXZBdHRMIiwgbWVhbiA9IG1lYW5TaW1fbm9sb3dfZnJlcSksDQogICAgZGF0YS5mcmFtZShjb25kPSJOb19hdkF0dEgiLCBtZWFuID0gbWVhblNpbV9ub2hpZ2hfZnJlcSkNCiAgKQ0KICBwbG90X2RhdGFfdm9sIDwtIHJiaW5kKA0KICAgIGRhdGEuZnJhbWUoY29uZD0iT2JzZXJ2ZWQiLCBtZWFuID0gbWVhblNpbU9fdm9sKSwNCiAgICBkYXRhLmZyYW1lKGNvbmQ9Ik5vX2luZiIsIG1lYW4gPSBtZWFuU2ltX25vaW5mX3ZvbCksDQogICAgZGF0YS5mcmFtZShjb25kPSJJbmRlZyIsIG1lYW4gPSBtZWFuU2ltX2luZGVnX3ZvbCksDQogICAgZGF0YS5mcmFtZShjb25kPSJOb19hdkF0dEwiLCBtZWFuID0gbWVhblNpbV9ub2xvd192b2wpLA0KICAgIGRhdGEuZnJhbWUoY29uZD0iTm9fYXZBdHRIIiwgbWVhbiA9IG1lYW5TaW1fbm9oaWdoX3ZvbCkNCiAgKQ0KICANCiAgIyByZW9yZGVyIGNvbmRpdGlvbnMNCiAgcGxvdF9kYXRhX2ZyZXEkY29uZCA8LSBmYWN0b3IocGxvdF9kYXRhX2ZyZXEkY29uZCwgbGV2ZWxzPWMoIk9ic2VydmVkIiwgIk5vX2luZiIsICJJbmRlZyIsICJOb19hdkF0dEwiLCAiTm9fYXZBdHRIIikpDQogIHBsb3RfZGF0YV92b2wkY29uZCA8LSBmYWN0b3IocGxvdF9kYXRhX3ZvbCRjb25kLCBsZXZlbHM9YygiT2JzZXJ2ZWQiLCAiTm9faW5mIiwgIkluZGVnIiwgIk5vX2F2QXR0TCIsICJOb19hdkF0dEgiKSkNCiAgY29sb3IgPC0gYnJld2VyLnBhbCg1LCAiU2V0MyIpICMgZ2V0IGNvbG9ycyBmb3IgYm94cGxvdHMNCiAgew0KICAgIGJveHBsb3QobWVhbiB+IGNvbmQsIGRhdGEgPSBwbG90X2RhdGFfZnJlcSwgbWFpbiA9IHBhc3RlKCJTaW11bGF0aW9uIHJlc3VsdHMgYWNyb3NzIiwgbkl0ZXIsICJpdGVyYXRpb25zIiksDQogICAgICAgICAgICB4bGFiID0gIlNpbXVsYXRpb24iLCB5bGFiID0gIkF2ZXJhZ2UgcnVubmluZyBmcmVxdWVuY3kiLCBjb2wgPSBjb2xvcikNCiAgICAjYWJsaW5lKGg9bWVhbk9ic19mcmVxLCBjb2wgPSAiYnJvd24iKSAjIGFkZCB0aGUgb2JzZXJ2ZWQgbWVhbiBydW5uaW5nIGF0IHQyDQogIH0NCiAgew0KICAgIGJveHBsb3QobWVhbiB+IGNvbmQsIGRhdGEgPSBwbG90X2RhdGFfdm9sLCBtYWluID0gcGFzdGUoIlNpbXVsYXRpb24gcmVzdWx0cyBhY3Jvc3MiLCBuSXRlciwgIml0ZXJhdGlvbnMiKSwNCiAgICAgICAgICAgIHhsYWIgPSAiU2ltdWxhdGlvbiBtb2RlbCIsIHlsYWIgPSAiQXZlcmFnZSBydW5uaW5nIHZvbHVtZSIsIGNvbCA9IGNvbG9yKQ0KICAgICNhYmxpbmUoaD1tZWFuT2JzX2ZyZXEsIGNvbCA9ICJicm93biIpICMgYWRkIHRoZSBvYnNlcnZlZCBtZWFuIHJ1bm5pbmcgYXQgdDINCiAgfQ0KICANCiAgIyByZWNvcmQgdGhlIHBsb3QgYW5kIHB1dCBpdCBpbiB0aGUgbGlzdA0KICBwbG90TFtbY11dIDwtIHJlY29yZFBsb3QoKQ0KDQp9DQoNCmBgYCAgDQoNCg0KPCEtLSAgIyMjDQogIA0KICAjIEkgZXhhbWluZSB0aGUgcnVubmluZyBmcmVxdWVuY3kgY2hhbmdlcyBpbiBncmVhdGVyIGRldGFpbA0KICBuX2FjdG9ycyA8LSBjbHViJG5ldHNpemUNCiAgDQogIFpzNSA8LSBhcnJheShOQSwgZGltPWMobl9hY3RvcnMsMSkpDQogIFpiNSA8LSBhcnJheSAoMCwgZGltPWMobkl0ZXIsMSkpDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGZvciAoaiBpbiAxOm5fYWN0b3JzKSB7DQogICAgICAjIHNpbXVsYXRlZCBiZWhhdmlvciBvZiBhY3RvciBqIGluIGl0ZXJhdGlvbiBpDQogICAgICBaczVbaiwxXSA8LSBzaW1fYW5zJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV1bW2pdXSANCiAgICB9DQogICAgIyBtZWFuIHNpbXVsYXRlZCBiZWhhdmlvciBvdmVyIGFjdG9ycyBpbiBpdGVyYXRpb24gaQ0KICAgIFpiNVtpXSA8LWNvbFN1bXMoWnM1LCBuYS5ybT1UKS9uX2FjdG9ycw0KICB9DQogIA0KICAjY29sTWVhbnMoY2JpbmQoY2x1YiRmcmVxX3J1blssLDE6Ml0pKSAjIG9ic2VydmVkIG1lYW5zIGF0IHQxIGFuZCB0Mg0KICAjY29sTWVhbnMoWmI1KSAgIyBhdmVyYWdlIG1lYW4gc2ltdWxhdGVkIGJlaGF2aW9yIHZhbHVlDQogICNtZWFuKCBzaW1fYW5zJHNpbXNbW25JdGVyXV1bWzFdXSRmcmVxX3J1bltbMV1dICkjIG1lYW4gb2YgbGFzdCBzaW11bGF0aW9uIHJ1bg0KICANCiAgDQogICMgSSBwbG90IHRoZSBtZWFuIHNpbXVsYXRlZCBydW5uaW5nIGZyZXF1ZW5jeSBvdmVyIHRpbWUgDQogICMgZXh0cmFjdCBtZWFuIHJ1bm5pbmcgZm9yIGFsbCBjaGFpbnMsIHdpdGggbmV0d29yayBjaGFuZ2Ugb3Bwb3J0dW5pdGllcyBpbmNsdWRlZA0KICBzaW1DaGFuZ2VzIDwtIHJlcCgwLCBuSXRlcikNCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7c2ltQ2hhbmdlc1tpXSA8LSBsZW5ndGgoc2ltX2FucyRjaGFpbltbaV1dW1sxXV1bWzFdXSkgfQ0KICBtYXhDaGFuZ2VzIDwtIG1heChzaW1DaGFuZ2VzKQ0KICANCiAgc2VxcyA8LSBtYXRyaXgoWmI1LCBucj0gbkl0ZXIsIG5jPW1heENoYW5nZXMrMSkgICMgZmlsbCBtYXRyaXggd2l0aCBmaW5hbCBtZWFuDQogIHNlcXNbLDFdIDwtIG1lYW4oY2x1YiRmcmVxX3J1blssLDFdKSAgICMgc2V0IHQxIG1lYW4gdG8gb2JzZXJ2ZWQgbGV2ZWwNCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZGF0Q2hhaW4gPC0gdChtYXRyaXgodW5saXN0KHNpbV9hbnMkY2hhaW5bW2ldXVtbMV1dW1sxXV0pLCBuYz1sZW5ndGgoc2ltX2FucyRjaGFpbltbaV1dW1sxXV1bWzFdXSkpKSANCiAgICBmb3IgKGogaW4gMTogc2ltQ2hhbmdlc1tpXSkgew0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIwIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdDQogICAgICB9DQogICAgICBpZiAoZGF0Q2hhaW5baiwyXT09IjEiKSB7IA0KICAgICAgICBzZXFzW2ksaisxXSA8LSBzZXFzW2ksal0gKyAoYXMubnVtZXJpYyhkYXRDaGFpbltqLDZdKS9uX2FjdG9ycykNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgIyBwbG90IG11bHRpcGxlIGl0ZXJhdGlvbnMgdXNpbmcgbG9lc3MgY3VydmVzDQogIG1pY3JvcyA8LSAxOmRpbShzZXFzKVsyXQ0KICBsbzEgPC0gbG9lc3Moc2Vxc1sxLF0gfiBtaWNyb3MpDQogIGwxIDwtIHByZWRpY3QobG8xLCBtaWNyb3MpDQogIA0KICAjIHNldCB5bGltOyBzbyBpdCBpcyBjb25zaXN0ZW50IGFjcm9zcyBwbG90cw0KICB5bWluIDwtIHBseXI6OnJvdW5kX2FueShtaW4oc2VxcywgbmEucm09VFJVRSksIC41LCBmPWZsb29yKQ0KICB5bWF4IDwtIHBseXI6OnJvdW5kX2FueShtYXgoc2VxcywgbmEucm09VFJVRSksIC41LCBmPWNlaWxpbmcpDQogIA0KICBwbG90KHg9MTpkaW0oc2VxcylbMl0sIHk9c2Vxc1sxLF0sIHlsaW09Yyh5bWluLHltYXgpLHR5cGU9ImwiLCANCiAgICAgICB5bGFiPSdBdmVyYWdlIHJ1bm5pbmcgZnJlcXVlbmN5JywgeGxhYj0nTWljcm8tc3RlcCcsIGNvbD0nd2hpdGUnLA0KICAgICAgIG1haW49J01lYW4gcnVubmluZyBvdmVyIHRpbWU6DQogICAgIGZ1bGwgbW9kZWwnKQkNCiAgZm9yIChpIGluIDE6MjUpIHsNCiAgICBsaW5lcyh4PW1pY3JvcywgeT1wcmVkaWN0KGxvZXNzKHNlcXNbaSxdIH4gbWljcm9zKSwgbWljcm9zKSwgY29sPWNvbG9ycygpW2kqMTBdKQ0KICB9DQogIA0KICAjIGRvIHRoZSBzYW1lIGZvciB0aGUgbW9kZWwgd2l0aCBubyBwZWVyIGluZmx1ZW5jZSB3aGF0c29ldmVyLiANCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZm9yIChqIGluIDE6bl9hY3RvcnMpIHsNCiAgICAgICMgc2ltdWxhdGVkIGJlaGF2aW9yIG9mIGFjdG9yIGogaW4gaXRlcmF0aW9uIGkNCiAgICAgIFpzNVtqLDFdIDwtIHNpbV9hbnNfbm9pbmYkc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXVtbal1dIA0KICAgIH0NCiAgICAjIG1lYW4gc2ltdWxhdGVkIGJlaGF2aW9yIG92ZXIgYWN0b3JzIGluIGl0ZXJhdGlvbiBpDQogICAgWmI1W2ldIDwtY29sU3VtcyhaczUsIG5hLnJtPVQpL25fYWN0b3JzDQogIH0NCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZGF0Q2hhaW4gPC0gdChtYXRyaXgodW5saXN0KHNpbV9hbnNfbm9pbmYkY2hhaW5bW2ldXVtbMV1dW1sxXV0pLCBuYz1sZW5ndGgoc2ltX2Fuc19ub2luZiRjaGFpbltbaV1dW1sxXV1bWzFdXSkpKSANCiAgICBmb3IgKGogaW4gMTogc2ltQ2hhbmdlc1tpXSkgew0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIwIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdDQogICAgICB9DQogICAgICBpZiAoZGF0Q2hhaW5baiwyXT09IjEiKSB7IA0KICAgICAgICBzZXFzW2ksaisxXSA8LSBzZXFzW2ksal0gKyAoYXMubnVtZXJpYyhkYXRDaGFpbltqLDZdKS9uX2FjdG9ycykNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgbWljcm9zIDwtIDE6ZGltKHNlcXMpWzJdDQogIGxvMSA8LSBsb2VzcyhzZXFzWzEsXSB+IG1pY3JvcykNCiAgbDEgPC0gcHJlZGljdChsbzEsIG1pY3JvcykNCiAgDQogIHBsb3QoeD0xOmRpbShzZXFzKVsyXSwgeT1zZXFzWzEsXSwgeWxpbT1jKHltaW4seW1heCksdHlwZT0ibCIsIA0KICAgICAgIHlsYWI9J0F2ZXJhZ2UgcnVubmluZyBmcmVxdWVuY3knLCB4bGFiPSdNaWNyby1zdGVwJywgY29sPSd3aGl0ZScsDQogICAgICAgbWFpbj0nTWVhbiBydW5uaW5nIG92ZXIgdGltZToNCiAgICAgbm8gaW5mbHVlbmNlJykJDQogIGZvciAoaSBpbiAxOjI1KSB7DQogICAgbGluZXMoeD1taWNyb3MsIHk9cHJlZGljdChsb2VzcyhzZXFzW2ksXSB+IG1pY3JvcyksIG1pY3JvcyksIGNvbD1jb2xvcnMoKVtpKjEwXSkNCiAgfQ0KICANCiAgIyBubyBkb3dud2FyZCBhc3NpbWlsYXRpb24uIA0KICBmb3IgKGkgaW4gMTogbkl0ZXIpIHsNCiAgICBmb3IgKGogaW4gMTpuX2FjdG9ycykgew0KICAgICAgIyBzaW11bGF0ZWQgYmVoYXZpb3Igb2YgYWN0b3IgaiBpbiBpdGVyYXRpb24gaQ0KICAgICAgWnM1W2osMV0gPC0gc2ltX2Fuc19ub2xvdyRzaW1zW1tpXV1bWzFdXSRmcmVxX3J1bltbMV1dW1tqXV0gDQogICAgfQ0KICAgICMgbWVhbiBzaW11bGF0ZWQgYmVoYXZpb3Igb3ZlciBhY3RvcnMgaW4gaXRlcmF0aW9uIGkNCiAgICBaYjVbaV0gPC1jb2xTdW1zKFpzNSwgbmEucm09VCkvbl9hY3RvcnMNCiAgfQ0KICANCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZGF0Q2hhaW4gPC0gdChtYXRyaXgodW5saXN0KHNpbV9hbnNfbm9sb3ckY2hhaW5bW2ldXVtbMV1dW1sxXV0pLCBuYz1sZW5ndGgoc2ltX2Fuc19ub2xvdyRjaGFpbltbaV1dW1sxXV1bWzFdXSkpKSANCiAgICBmb3IgKGogaW4gMTogc2ltQ2hhbmdlc1tpXSkgew0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIwIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdDQogICAgICB9DQogICAgICBpZiAoZGF0Q2hhaW5baiwyXT09IjEiKSB7IA0KICAgICAgICBzZXFzW2ksaisxXSA8LSBzZXFzW2ksal0gKyAoYXMubnVtZXJpYyhkYXRDaGFpbltqLDZdKS9uX2FjdG9ycykNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgbWljcm9zIDwtIDE6ZGltKHNlcXMpWzJdDQogIGxvMSA8LSBsb2VzcyhzZXFzWzEsXSB+IG1pY3JvcykNCiAgbDEgPC0gcHJlZGljdChsbzEsIG1pY3JvcykNCiAgDQogIHBsb3QoeD0xOmRpbShzZXFzKVsyXSwgeT1zZXFzWzEsXSwgeWxpbT1jKHltaW4seW1heCksdHlwZT0ibCIsIA0KICAgICAgIHlsYWI9J0F2ZXJhZ2UgcnVubmluZyBmcmVxdWVuY3knLCB4bGFiPSdNaWNyby1zdGVwJywgY29sPSd3aGl0ZScsDQogICAgICAgbWFpbj0nTWVhbiBydW5uaW5nIG92ZXIgdGltZToNCiAgICAgbm8gYXZBdHRMb3dlcicpCQ0KICBmb3IgKGkgaW4gMToyNSkgew0KICAgIGxpbmVzKHg9bWljcm9zLCB5PXByZWRpY3QobG9lc3Moc2Vxc1tpLF0gfiBtaWNyb3MpLCBtaWNyb3MpLCBjb2w9Y29sb3JzKClbaSoxMF0pDQogIH0NCiAgDQogICMgbm8gdXB3YXJkIGFzc2ltaWxhdGlvbi4gDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGZvciAoaiBpbiAxOm5fYWN0b3JzKSB7DQogICAgICAjIHNpbXVsYXRlZCBiZWhhdmlvciBvZiBhY3RvciBqIGluIGl0ZXJhdGlvbiBpDQogICAgICBaczVbaiwxXSA8LSBzaW1fYW5zX25vaGlnaCRzaW1zW1tpXV1bWzFdXSRmcmVxX3J1bltbMV1dW1tqXV0gDQogICAgfQ0KICAgICMgbWVhbiBzaW11bGF0ZWQgYmVoYXZpb3Igb3ZlciBhY3RvcnMgaW4gaXRlcmF0aW9uIGkNCiAgICBaYjVbaV0gPC1jb2xTdW1zKFpzNSwgbmEucm09VCkvbl9hY3RvcnMNCiAgfQ0KICANCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZGF0Q2hhaW4gPC0gdChtYXRyaXgodW5saXN0KHNpbV9hbnNfbm9oaWdoJGNoYWluW1tpXV1bWzFdXVtbMV1dKSwgbmM9bGVuZ3RoKHNpbV9hbnNfbm9oaWdoJGNoYWluW1tpXV1bWzFdXVtbMV1dKSkpIA0KICAgIGZvciAoaiBpbiAxOiBzaW1DaGFuZ2VzW2ldKSB7DQogICAgICBpZiAoZGF0Q2hhaW5baiwyXT09IjAiKSB7IA0KICAgICAgICBzZXFzW2ksaisxXSA8LSBzZXFzW2ksal0NCiAgICAgIH0NCiAgICAgIGlmIChkYXRDaGFpbltqLDJdPT0iMSIpIHsgDQogICAgICAgIHNlcXNbaSxqKzFdIDwtIHNlcXNbaSxqXSArIChhcy5udW1lcmljKGRhdENoYWluW2osNl0pL25fYWN0b3JzKQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICBtaWNyb3MgPC0gMTpkaW0oc2VxcylbMl0NCiAgbG8xIDwtIGxvZXNzKHNlcXNbMSxdIH4gbWljcm9zKQ0KICBsMSA8LSBwcmVkaWN0KGxvMSwgbWljcm9zKQ0KICANCiAgcGxvdCh4PTE6ZGltKHNlcXMpWzJdLCB5PXNlcXNbMSxdLCB5bGltPWMoeW1pbix5bWF4KSx0eXBlPSJsIiwgDQogICAgICAgeWxhYj0nQXZlcmFnZSBydW5uaW5nIGZyZXF1ZW5jeScsIHhsYWI9J01pY3JvLXN0ZXAnLCBjb2w9J3doaXRlJywNCiAgICAgICBtYWluPSdNZWFuIHJ1bm5pbmcgb3ZlciB0aW1lOg0KICAgICBubyBhdkF0dEhpZ2hlcicpCQ0KICBmb3IgKGkgaW4gMToyNSkgew0KICAgIGxpbmVzKHg9bWljcm9zLCB5PXByZWRpY3QobG9lc3Moc2Vxc1tpLF0gfiBtaWNyb3MpLCBtaWNyb3MpLCBjb2w9Y29sb3JzKClbaSoxMF0pDQogIH0NCiAgDQogICNzYXZlIHRoZSBwbG90IHRvIHRoZSBsaXN0DQogIHBsb3RMW1tjXV0gPC0gcmVjb3JkUGxvdCgpDQoNCn0NCg0KDQotLT4NCg0KDQo8YnI+DQoNCiMgUGxvdHMgey50YWJzZXQgLnRhYnNldC1mYWRlfQ0KDQojIyBjbHViIDENCg0KIVtdKGFibV9wbG90X2NsdWIxLnBuZykNCg0KIyMgY2x1YiAyDQoNCiFbXShhYm1fcGxvdF9jbHViMi5wbmcpDQoNCiMjIGNsdWIgMw0KDQohW10oYWJtX3Bsb3RfY2x1YjMucG5nKQ0KDQojIyBjbHViIDQNCg0KIVtdKGFibV9wbG90X2NsdWI0LnBuZykNCg0KIyMgY2x1YiA1DQoNCiFbXShhYm1fcGxvdF9jbHViNS5wbmcpDQoNCiMgey19DQo=</div>
<style>
.center {
  text-align: center;
  color: red;
}
</style>

<hr>
<br>
<p class="center">Copyright &copy; 2021 Rob Franken</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("simulations.rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

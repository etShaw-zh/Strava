<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>SAOM as ABM</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="prep.html">Preparation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Descriptives
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="des.html">Procedure</a>
    </li>
    <li>
      <a href="destab.html">Table 1: Descriptives</a>
    </li>
    <li>
      <a href="desfig.html">Figure 5: Development of the mean running</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Model selection
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="explore.html">Club 1</a>
    </li>
    <li>
      <a href="other.html">Clubs 2-5</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Meta-analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="meta.html">Running frequency models</a>
    </li>
    <li>
      <a href="vol_meta.html">Running volume models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    GOF
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GOF1.html">Running frequency models</a>
    </li>
    <li>
      <a href="GOF2.html">Running volume</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Influence effects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="influenceeffects.html">Different influence operationalizations</a>
    </li>
    <li>
      <a href="figure3.html">Figure 6: Ego-alter influence plot</a>
    </li>
    <li>
      <a href="RI.html">Figure 7: Relative importance of effects</a>
    </li>
    <li>
      <a href="simulations.html">Empirically calibrated SAOMs</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robfranken/Strava">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">SAOM as ABM</h1>
<h4 class="date">Last compiled on maart, 2022</h4>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<hr />
<p>Aim: to explore how consequential influence effects are for the
running behavior (here, frequency) across clubs.</p>
<p>I reduced the data to only two time-points. Initial effect values are
set based on the estimated model parameters of tables 2 and 3 of the
manuscript.</p>
<p>I specify additional models: 1) with no peer influence effects
whatsoever; 2) with only upward assimilation (avAttHigher); 3) with only
downward assimilation (avAttLower).</p>
<p>100 simulations were run.</p>
<hr />
<p><br></p>
<div id="preparation" class="section level1">
<h1>Preparation</h1>
<p>Clean the working environment. Required packages:</p>
<pre class="r test"><code># clean the working environment
rm(list = ls())

# packages:
library(RSiena)
library(sna)
library(lattice)  # for plotting
library(RColorBrewer)  # color palettes</code></pre>
<p><br></p>
<p>Load the club list, to set up our starting networks</p>
<pre class="r test"><code>load(&quot;clubdata.RData&quot;)</code></pre>
<p><br></p>
<p>The following scripts makes plots for all 5 clubs:</p>
<ul>
<li>boxplots illustrating how average running behavior values differ
across different simulation models.</li>
<li>the development of the average running behavior for all sequences of
micro-steps simulated (with both behavior and network change
opportunities included)</li>
</ul>
<pre class="r test"><code>plotL &lt;- list() # list to store plots in

for (c in 1:length(clubdata)) {
 
  # pick club
  club &lt;- clubdata[[c]]
  
  # we reduce the data to only two time points
  kudonet &lt;- sienaDependent(club$kudo[,,1:2], allowOnly = FALSE)
  freq_run &lt;- sienaDependent(club$freq_run[,,1:2], type = &quot;behavior&quot;, allowOnly = FALSE) 
  
  # covariates
  # changing covariates not possible with only 2 waves, so we make other activity a constant
  freq_other &lt;- coCovar(club$freq_other[, ,1])
  gender &lt;- coCovar(ifelse(club$male == 1, 1, 2))
  
  # create a RSiena data object
  mydata &lt;- sienaDataCreate(kudonet, freq_run, freq_other, gender)
  
  # load in the sienaFit object list, containing estimated parameters
  load(paste0(&quot;test/sienaFit/sienaFit_club&quot;, c, &quot;.RData&quot;))
  ans &lt;- sienaFit[[5]] # get object for main model (m5)

  # make effects object
  myeff &lt;- getEffects(mydata)
  # set initial values of basic effects for simulations based on estimated model
  myeff$initialValue[myeff$include==T] &lt;- ans$theta[c(1,12,13,25,36,37)]
  
  # include extra effects and set initial value
  myeff &lt;- setEffect(myeff, gwespFF, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;gwespFF&quot;)])
  myeff &lt;- setEffect(myeff, outActSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outActSqrt&quot;)])
  myeff &lt;- setEffect(myeff, inPopSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;inPopSqrt&quot;)])
  myeff &lt;- setEffect(myeff, outPopSqrt, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outPopSqrt&quot;)])
  myeff &lt;- setEffect(myeff, reciAct, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;reciAct&quot;)])
  myeff &lt;- setEffect(myeff, outIso, name = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;outIso&quot;)])
  myeff &lt;- includeInteraction(myeff, recip, gwespFF, parameter = 69, name = &quot;kudonet&quot;)
  (eff1 &lt;- myeff[myeff$include, ]$effect1[10])
  (eff2 &lt;- myeff[myeff$include, ]$effect2[10])
  myeff &lt;- setEffect(myeff, unspInt, effect1 = eff1, effect2 = eff2, initialValue = ans$theta[which(ans$effects$shortName==&quot;unspInt&quot;)])
  myeff &lt;- setEffect(myeff, higher, name = &quot;kudonet&quot;, interaction1 = &quot;freq_run&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;higher&quot;)])
  myeff &lt;- setEffect(myeff, egoX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;egoX&quot;)])
  myeff &lt;- setEffect(myeff, altX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;altX&quot;)])
  myeff &lt;- setEffect(myeff, sameX, name = &quot;kudonet&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;sameX&quot;)])
  myeff &lt;- setEffect(myeff, effFrom, name = &quot;freq_run&quot;, interaction1 = &quot;freq_other&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;effFrom&quot; &amp; ans$effects$interaction1==&quot;freq_other&quot;)])
  myeff &lt;- setEffect(myeff, effFrom, name = &quot;freq_run&quot;, interaction1 = &quot;gender&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;effFrom&quot; &amp; ans$effects$interaction1==&quot;gender&quot;)])
  myeff &lt;- setEffect(myeff, indeg, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;indeg&quot;)])
  myeff &lt;- setEffect(myeff, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttHigher&quot;)])
  myeff &lt;- setEffect(myeff, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = ans$theta[which(ans$effects$shortName==&quot;avAttLower&quot;)])
  # fix effects at this value
  myeff$fix[myeff$include==T] &lt;- TRUE 
  
  # I also specify models with no social influence, 
  myeff_noinf &lt;- setEffect(myeff, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  myeff_noinf &lt;- setEffect(myeff_noinf, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  # only upward assimilation,
  myeff_nolow &lt;- setEffect(myeff, avAttLower, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  # and only downward assimilation
  myeff_nohigh &lt;- setEffect(myeff, avAttHigher, name = &quot;freq_run&quot;, interaction1 = &quot;kudonet&quot;, initialValue = 0, fix = TRUE)
  
  # set up the simulation settings
  nIter &lt;- 100 # number of iterations
  sim_model &lt;- sienaAlgorithmCreate(
    projname = &#39;sim_test1&#39;,
    cond = FALSE,
    useStdInits = FALSE, nsub = 0,
    n3 = nIter, 
    seed=242452, # seed for replication
    simOnly = TRUE)
  
  # I will extract the mean running frequency values from the simulation runs
  # make vectors to store means
  meanSimO &lt;- rep(0, nIter)
  meanSim_noinf &lt;- rep(0, nIter)
  meanSim_nolow &lt;- rep(0, nIter)
  meanSim_nohigh &lt;- rep(0, nIter)
  
  # simulation using estimated parameters
  sim_ans &lt;- siena07(sim_model,          # simulation settings
                     data = mydata,      # data
                     effects = myeff,    # defined effects and set parameters
                     returnDeps = TRUE,  # return simulated networks and behaviors
                     returnChains = TRUE,# return sequences of micro-steps
                     batch = TRUE)
  sim_ans_noinf &lt;- siena07(sim_model,         
                           data = mydata,     
                           effects = myeff_noinf,   
                           returnDeps = TRUE, 
                           returnChains = TRUE,
                           batch = TRUE)
  sim_ans_nolow &lt;- siena07(sim_model,         
                           data = mydata,     
                           effects = myeff_nolow,   
                           returnDeps = TRUE, 
                           returnChains = TRUE,
                           batch = TRUE)
  sim_ans_nohigh &lt;- siena07(sim_model,         
                            data = mydata,     
                            effects = myeff_nohigh,   
                            returnDeps = TRUE, 
                            returnChains = TRUE,
                            batch = TRUE)
  
  # extract mean behavior values from simulation runs
  for (i in 1:nIter) {
    meanSimO[i] &lt;- mean(sim_ans$sims[[i]][[1]]$freq_run[[1]])
    meanSim_noinf[i] &lt;- mean(sim_ans_noinf$sims[[i]][[1]]$freq_run[[1]])
    meanSim_nolow[i] &lt;- mean(sim_ans_nolow$sims[[i]][[1]]$freq_run[[1]])
    meanSim_nohigh[i] &lt;- mean(sim_ans_nohigh$sims[[i]][[1]]$freq_run[[1]])
  }
  #str(sim_ans$sims[[1]]) # numbering is as follows: nIter, group number, DV, period number
  
  # also store observed mean freq_run at t2
  meanObs &lt;- mean(club$freq_run[,,2])
  
  #  make a layout for the plots
  dev.off()
  l &lt;- layout(matrix(c(1, 1, 6, 6,  # First
                       2, 3, 4, 5), # and third plot
                     nrow = 2,
                     ncol = 4,
                     byrow = TRUE))
  #layout.show(l)
  
  # make data for plotting
  plot_data &lt;- rbind(
    data.frame(cond=&quot;Observed&quot;, mean = meanSimO),
    data.frame(cond=&quot;No_inf&quot;, mean = meanSim_noinf),
    data.frame(cond=&quot;No_avAttL&quot;, mean = meanSim_nolow),
    data.frame(cond=&quot;No_avAttH&quot;, mean = meanSim_nohigh)
  )
  
  # reorder conditions
  plot_data$cond &lt;- factor(plot_data$cond, levels=c(&quot;Observed&quot;, &quot;No_inf&quot;, &quot;No_avAttL&quot;, &quot;No_avAttH&quot;))
  color &lt;- brewer.pal(4, &quot;Set3&quot;) # get colors for boxplots
  boxplot(mean ~ cond, data = plot_data, main = paste(&quot;Simulation results across&quot;, nIter, &quot;iterations&quot;),
          xlab = &quot;Simulation&quot;, ylab = &quot;Average running frequency&quot;, col = color)
  abline(h=meanObs, col = &quot;brown&quot;) # add the observed mean running at t2
  
  # I examine the running frequency changes in greater detail
  n_actors &lt;- club$netsize
  
  Zs5 &lt;- array(NA, dim=c(n_actors,1))
  Zb5 &lt;- array (0, dim=c(nIter,1))
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] &lt;- sim_ans$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] &lt;-colSums(Zs5, na.rm=T)/n_actors
  }
  
  #colMeans(cbind(club$freq_run[,,1:2])) # observed means at t1 and t2
  #colMeans(Zb5)  # average mean simulated behavior value
  #mean( sim_ans$sims[[nIter]][[1]]$freq_run[[1]] )# mean of last simulation run
  
  
  # I plot the mean simulated running frequency over time 
  # extract mean drinking for all chains, with network change opportunities included
  simChanges &lt;- rep(0, nIter)
  for (i in 1: nIter) {simChanges[i] &lt;- length(sim_ans$chain[[i]][[1]][[1]]) }
  maxChanges &lt;- max(simChanges)
  
  seqs &lt;- matrix(Zb5, nr= nIter, nc=maxChanges+1)  # fill matrix with final mean
  seqs[,1] &lt;- mean(club$freq_run[,,1])   # set t1 mean to observed level
  for (i in 1: nIter) {
    datChain &lt;- t(matrix(unlist(sim_ans$chain[[i]][[1]][[1]]), nc=length(sim_ans$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]==&quot;0&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j]
      }
      if (datChain[j,2]==&quot;1&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  # plot multiple iterations using loess curves
  micros &lt;- 1:dim(seqs)[2]
  lo1 &lt;- loess(seqs[1,] ~ micros)
  l1 &lt;- predict(lo1, micros)
  
  # set ylim; so it is consistent across plots
  ymin &lt;- plyr::round_any(min(seqs), .5, f=floor)
  ymax &lt;- plyr::round_any(max(seqs), .5, f=ceiling)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type=&quot;l&quot;, 
       ylab=&#39;Average running frequency&#39;, xlab=&#39;Micro-step&#39;, col=&#39;white&#39;,
       main=&#39;Mean running over time:
     full model&#39;)   
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # do the same for the model with no peer influence whatsoever. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] &lt;- sim_ans_noinf$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] &lt;-colSums(Zs5, na.rm=T)/n_actors
  }
  for (i in 1: nIter) {
    datChain &lt;- t(matrix(unlist(sim_ans_noinf$chain[[i]][[1]][[1]]), nc=length(sim_ans_noinf$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]==&quot;0&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j]
      }
      if (datChain[j,2]==&quot;1&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros &lt;- 1:dim(seqs)[2]
  lo1 &lt;- loess(seqs[1,] ~ micros)
  l1 &lt;- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type=&quot;l&quot;, 
       ylab=&#39;Average running frequency&#39;, xlab=&#39;Micro-step&#39;, col=&#39;white&#39;,
       main=&#39;Mean running over time:
     no influence&#39;) 
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # no downward assimilation. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] &lt;- sim_ans_nolow$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] &lt;-colSums(Zs5, na.rm=T)/n_actors
  }
  
  for (i in 1: nIter) {
    datChain &lt;- t(matrix(unlist(sim_ans_nolow$chain[[i]][[1]][[1]]), nc=length(sim_ans_nolow$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]==&quot;0&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j]
      }
      if (datChain[j,2]==&quot;1&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros &lt;- 1:dim(seqs)[2]
  lo1 &lt;- loess(seqs[1,] ~ micros)
  l1 &lt;- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type=&quot;l&quot;, 
       ylab=&#39;Average running frequency&#39;, xlab=&#39;Micro-step&#39;, col=&#39;white&#39;,
       main=&#39;Mean running over time:
     no avAttLower&#39;)    
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  # no upward assimilation. 
  for (i in 1: nIter) {
    for (j in 1:n_actors) {
      # simulated behavior of actor j in iteration i
      Zs5[j,1] &lt;- sim_ans_nohigh$sims[[i]][[1]]$freq_run[[1]][[j]] 
    }
    # mean simulated behavior over actors in iteration i
    Zb5[i] &lt;-colSums(Zs5, na.rm=T)/n_actors
  }
  
  for (i in 1: nIter) {
    datChain &lt;- t(matrix(unlist(sim_ans_nohigh$chain[[i]][[1]][[1]]), nc=length(sim_ans_nohigh$chain[[i]][[1]][[1]]))) 
    for (j in 1: simChanges[i]) {
      if (datChain[j,2]==&quot;0&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j]
      }
      if (datChain[j,2]==&quot;1&quot;) { 
        seqs[i,j+1] &lt;- seqs[i,j] + (as.numeric(datChain[j,6])/n_actors)
      }
    }
  }
  micros &lt;- 1:dim(seqs)[2]
  lo1 &lt;- loess(seqs[1,] ~ micros)
  l1 &lt;- predict(lo1, micros)
  
  plot(x=1:dim(seqs)[2], y=seqs[1,], ylim=c(ymin,ymax),type=&quot;l&quot;, 
       ylab=&#39;Average running frequency&#39;, xlab=&#39;Micro-step&#39;, col=&#39;white&#39;,
       main=&#39;Mean running over time:
     no avAttHigher&#39;)   
  for (i in 1:25) {
    lines(x=micros, y=predict(loess(seqs[i,] ~ micros), micros), col=colors()[i*10])
  }
  
  #save the plot to the list
  plotL[[c]] &lt;- recordPlot()

}</code></pre>
<p><br></p>
</div>
<div id="plots" class="section level1 tabset tabset-fade">
<h1 class="tabset tabset-fade">Plots</h1>
<div id="club-1" class="section level2">
<h2>club 1</h2>
<p><img src="plots_club1.png" /></p>
</div>
<div id="club-2" class="section level2">
<h2>club 2</h2>
<p><img src="plots_club2.png" /></p>
</div>
<div id="club-3" class="section level2">
<h2>club 3</h2>
<p><img src="plots_club3.png" /></p>
</div>
<div id="club-4" class="section level2">
<h2>club 4</h2>
<p><img src="plots_club4.png" /></p>
</div>
<div id="club-5" class="section level2">
<h2>club 5</h2>
<p><img src="plots_club5.png" /></p>
</div>
</div>
<div id="section" class="section level1 unnumbered">
<h1 class="unnumbered"></h1>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlNBT00gYXMgQUJNIg0KZGF0ZTogIkxhc3QgY29tcGlsZWQgb24gYHIgZm9ybWF0KFN5cy50aW1lKCksICclQiwgJVknKWAiDQpiaWJsaW9ncmFwaHk6IHJlZmVyZW5jZXMuYmliDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgY3NzOiB0d2Vha3MuY3NzDQogICAgdG9jOiB0cnVlDQogICAgdG9jX2Zsb2F0OiB0cnVlDQogICAgY29sbGFwc2VkOiBmYWxzZQ0KICAgIG51bWJlcl9zZWN0aW9uczogZmFsc2UNCiAgICB0b2NfZGVwdGg6IDENCiAgICBjb2RlX2ZvbGRpbmc6IHNob3cNCiAgICBjb2RlX2Rvd25sb2FkOiB5ZXMNCi0tLQ0KICANCmBgYHtyLCBnbG9iYWxzZXR0aW5ncywgZWNobz1GQUxTRSwgd2FybmluZz1GQUxTRSwgcmVzdWx0cz0naGlkZSd9DQpsaWJyYXJ5KGtuaXRyKQ0KbGlicmFyeShSU2llbmEpDQpsaWJyYXJ5KGdncGxvdDIpDQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpDQpvcHRzX2NodW5rJHNldCh0aWR5Lm9wdHM9bGlzdCh3aWR0aC5jdXRvZmY9MTAwKSx0aWR5PVRSVUUsIHdhcm5pbmcgPSBGQUxTRSwgbWVzc2FnZSA9IEZBTFNFLGNvbW1lbnQgPSAiIz4iLCBjYWNoZT1UUlVFLCBjbGFzcy5zb3VyY2U9YygidGVzdCIpLCBjbGFzcy5vdXRwdXQ9YygidGVzdDIiKSkNCm9wdGlvbnMod2lkdGggPSAxMDApDQpyZ2w6OnNldHVwS25pdHIoKQ0KDQpjb2xvcml6ZSA8LSBmdW5jdGlvbih4LCBjb2xvcikge3NwcmludGYoIjxzcGFuIHN0eWxlPSdjb2xvcjogJXM7Jz4lczwvc3Bhbj4iLCBjb2xvciwgeCkgfQ0KDQpgYGANCg0KYGBge3Iga2xpcHB5LCBlY2hvPUZBTFNFLCBpbmNsdWRlPVRSVUV9DQprbGlwcHk6OmtsaXBweShwb3NpdGlvbiA9IGMoJ3RvcCcsICdyaWdodCcpKQ0KI2tsaXBweTo6a2xpcHB5KGNvbG9yID0gJ2RhcmtyZWQnKQ0KI2tsaXBweTo6a2xpcHB5KHRvb2x0aXBfbWVzc2FnZSA9ICdDbGljayB0byBjb3B5JywgdG9vbHRpcF9zdWNjZXNzID0gJ0RvbmUnKQ0KYGBgDQoNCg0KDQotLS0NCiAgDQpBaW06IHRvIGV4cGxvcmUgaG93IGNvbnNlcXVlbnRpYWwgaW5mbHVlbmNlIGVmZmVjdHMgYXJlIGZvciB0aGUgcnVubmluZyBiZWhhdmlvciAoaGVyZSwgZnJlcXVlbmN5KSBhY3Jvc3MgY2x1YnMuDQoNCkkgcmVkdWNlZCB0aGUgZGF0YSB0byBvbmx5IHR3byB0aW1lLXBvaW50cy4gSW5pdGlhbCBlZmZlY3QgdmFsdWVzIGFyZSBzZXQgYmFzZWQgb24gdGhlIGVzdGltYXRlZCBtb2RlbCBwYXJhbWV0ZXJzIG9mIHRhYmxlcyAyIGFuZCAzIG9mIHRoZSBtYW51c2NyaXB0Lg0KDQpJIHNwZWNpZnkgYWRkaXRpb25hbCBtb2RlbHM6IDEpIHdpdGggbm8gcGVlciBpbmZsdWVuY2UgZWZmZWN0cyB3aGF0c29ldmVyOyAyKSB3aXRoIG9ubHkgdXB3YXJkIGFzc2ltaWxhdGlvbiAoYXZBdHRIaWdoZXIpOyAzKSB3aXRoIG9ubHkgZG93bndhcmQgYXNzaW1pbGF0aW9uIChhdkF0dExvd2VyKS4NCg0KMTAwIHNpbXVsYXRpb25zIHdlcmUgcnVuLg0KDQotLS0tDQoNCjxicj4NCg0KDQojIFByZXBhcmF0aW9uDQoNCkNsZWFuIHRoZSB3b3JraW5nIGVudmlyb25tZW50LiBSZXF1aXJlZCBwYWNrYWdlczoNCg0KYGBge3IsIGF0dHIub3V0cHV0PSdzdHlsZT0ibWF4LWhlaWdodDogMjAwcHg7Iid9DQojIGNsZWFuIHRoZSB3b3JraW5nIGVudmlyb25tZW50IA0Kcm0gKGxpc3QgPSBscyggKSkNCg0KIyBwYWNrYWdlczoNCmxpYnJhcnkoUlNpZW5hKQ0KbGlicmFyeShzbmEpDQpsaWJyYXJ5KGxhdHRpY2UpICAjIGZvciBwbG90dGluZw0KbGlicmFyeShSQ29sb3JCcmV3ZXIpICMgY29sb3IgcGFsZXR0ZXMNCmBgYA0KDQo8YnI+IA0KDQpMb2FkIHRoZSBjbHViIGxpc3QsIHRvIHNldCB1cCBvdXIgc3RhcnRpbmcgbmV0d29ya3MNCmBgYHtyIGV2YWw9VH0NCmxvYWQoImNsdWJkYXRhLlJEYXRhIikNCmBgYA0KDQo8YnI+DQoNClRoZSBmb2xsb3dpbmcgc2NyaXB0cyBtYWtlcyBwbG90cyBmb3IgYWxsIDUgY2x1YnM6IA0KDQotIGJveHBsb3RzIGlsbHVzdHJhdGluZyBob3cgYXZlcmFnZSBydW5uaW5nIGJlaGF2aW9yIHZhbHVlcyBkaWZmZXIgYWNyb3NzIGRpZmZlcmVudCBzaW11bGF0aW9uIG1vZGVscy4NCi0gdGhlIGRldmVsb3BtZW50IG9mIHRoZSBhdmVyYWdlIHJ1bm5pbmcgYmVoYXZpb3IgZm9yIGFsbCBzZXF1ZW5jZXMgb2YgbWljcm8tc3RlcHMgc2ltdWxhdGVkICh3aXRoIGJvdGggYmVoYXZpb3IgYW5kIG5ldHdvcmsgY2hhbmdlIG9wcG9ydHVuaXRpZXMgaW5jbHVkZWQpDQoNCg0KDQpgYGB7ciwgZXZhbD1GfQ0KcGxvdEwgPC0gbGlzdCgpICMgbGlzdCB0byBzdG9yZSBwbG90cyBpbg0KDQpmb3IgKGMgaW4gMTpsZW5ndGgoY2x1YmRhdGEpKSB7DQogDQogICMgcGljayBjbHViDQogIGNsdWIgPC0gY2x1YmRhdGFbW2NdXQ0KICANCiAgIyB3ZSByZWR1Y2UgdGhlIGRhdGEgdG8gb25seSB0d28gdGltZSBwb2ludHMNCiAga3Vkb25ldCA8LSBzaWVuYURlcGVuZGVudChjbHViJGt1ZG9bLCwxOjJdLCBhbGxvd09ubHkgPSBGQUxTRSkNCiAgZnJlcV9ydW4gPC0gc2llbmFEZXBlbmRlbnQoY2x1YiRmcmVxX3J1blssLDE6Ml0sIHR5cGUgPSAiYmVoYXZpb3IiLCBhbGxvd09ubHkgPSBGQUxTRSkgDQogIA0KICAjIGNvdmFyaWF0ZXMNCiAgIyBjaGFuZ2luZyBjb3ZhcmlhdGVzIG5vdCBwb3NzaWJsZSB3aXRoIG9ubHkgMiB3YXZlcywgc28gd2UgbWFrZSBvdGhlciBhY3Rpdml0eSBhIGNvbnN0YW50DQogIGZyZXFfb3RoZXIgPC0gY29Db3ZhcihjbHViJGZyZXFfb3RoZXJbLCAsMV0pDQogIGdlbmRlciA8LSBjb0NvdmFyKGlmZWxzZShjbHViJG1hbGUgPT0gMSwgMSwgMikpDQogIA0KICAjIGNyZWF0ZSBhIFJTaWVuYSBkYXRhIG9iamVjdA0KICBteWRhdGEgPC0gc2llbmFEYXRhQ3JlYXRlKGt1ZG9uZXQsIGZyZXFfcnVuLCBmcmVxX290aGVyLCBnZW5kZXIpDQogIA0KICAjIGxvYWQgaW4gdGhlIHNpZW5hRml0IG9iamVjdCBsaXN0LCBjb250YWluaW5nIGVzdGltYXRlZCBwYXJhbWV0ZXJzDQogIGxvYWQocGFzdGUwKCJ0ZXN0L3NpZW5hRml0L3NpZW5hRml0X2NsdWIiLCBjLCAiLlJEYXRhIikpDQogIGFucyA8LSBzaWVuYUZpdFtbNV1dICMgZ2V0IG9iamVjdCBmb3IgbWFpbiBtb2RlbCAobTUpDQoNCiAgIyBtYWtlIGVmZmVjdHMgb2JqZWN0DQogIG15ZWZmIDwtIGdldEVmZmVjdHMobXlkYXRhKQ0KICAjIHNldCBpbml0aWFsIHZhbHVlcyBvZiBiYXNpYyBlZmZlY3RzIGZvciBzaW11bGF0aW9ucyBiYXNlZCBvbiBlc3RpbWF0ZWQgbW9kZWwNCiAgbXllZmYkaW5pdGlhbFZhbHVlW215ZWZmJGluY2x1ZGU9PVRdIDwtIGFucyR0aGV0YVtjKDEsMTIsMTMsMjUsMzYsMzcpXQ0KICANCiAgIyBpbmNsdWRlIGV4dHJhIGVmZmVjdHMgYW5kIHNldCBpbml0aWFsIHZhbHVlDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgZ3dlc3BGRiwgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09Imd3ZXNwRkYiKV0pDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgb3V0QWN0U3FydCwgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09Im91dEFjdFNxcnQiKV0pDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgaW5Qb3BTcXJ0LCBuYW1lID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5Qb3BTcXJ0IildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIG91dFBvcFNxcnQsIG5hbWUgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJvdXRQb3BTcXJ0IildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIHJlY2lBY3QsIG5hbWUgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJyZWNpQWN0IildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIG91dElzbywgbmFtZSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09Im91dElzbyIpXSkNCiAgbXllZmYgPC0gaW5jbHVkZUludGVyYWN0aW9uKG15ZWZmLCByZWNpcCwgZ3dlc3BGRiwgcGFyYW1ldGVyID0gNjksIG5hbWUgPSAia3Vkb25ldCIpDQogIChlZmYxIDwtIG15ZWZmW215ZWZmJGluY2x1ZGUsIF0kZWZmZWN0MVsxMF0pDQogIChlZmYyIDwtIG15ZWZmW215ZWZmJGluY2x1ZGUsIF0kZWZmZWN0MlsxMF0pDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgdW5zcEludCwgZWZmZWN0MSA9IGVmZjEsIGVmZmVjdDIgPSBlZmYyLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0idW5zcEludCIpXSkNCiAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBoaWdoZXIsIG5hbWUgPSAia3Vkb25ldCIsIGludGVyYWN0aW9uMSA9ICJmcmVxX3J1biIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJoaWdoZXIiKV0pDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgZWdvWCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJlZ29YIildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGFsdFgsIG5hbWUgPSAia3Vkb25ldCIsIGludGVyYWN0aW9uMSA9ICJnZW5kZXIiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iYWx0WCIpXSkNCiAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBzYW1lWCwgbmFtZSA9ICJrdWRvbmV0IiwgaW50ZXJhY3Rpb24xID0gImdlbmRlciIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJzYW1lWCIpXSkNCiAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBlZmZGcm9tLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImZyZXFfb3RoZXIiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iZWZmRnJvbSIgJiBhbnMkZWZmZWN0cyRpbnRlcmFjdGlvbjE9PSJmcmVxX290aGVyIildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGVmZkZyb20sIG5hbWUgPSAiZnJlcV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAiZ2VuZGVyIiwgaW5pdGlhbFZhbHVlID0gYW5zJHRoZXRhW3doaWNoKGFucyRlZmZlY3RzJHNob3J0TmFtZT09ImVmZkZyb20iICYgYW5zJGVmZmVjdHMkaW50ZXJhY3Rpb24xPT0iZ2VuZGVyIildKQ0KICBteWVmZiA8LSBzZXRFZmZlY3QobXllZmYsIGluZGVnLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iaW5kZWciKV0pDQogIG15ZWZmIDwtIHNldEVmZmVjdChteWVmZiwgYXZBdHRIaWdoZXIsIG5hbWUgPSAiZnJlcV9ydW4iLCBpbnRlcmFjdGlvbjEgPSAia3Vkb25ldCIsIGluaXRpYWxWYWx1ZSA9IGFucyR0aGV0YVt3aGljaChhbnMkZWZmZWN0cyRzaG9ydE5hbWU9PSJhdkF0dEhpZ2hlciIpXSkNCiAgbXllZmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBhdkF0dExvd2VyLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSBhbnMkdGhldGFbd2hpY2goYW5zJGVmZmVjdHMkc2hvcnROYW1lPT0iYXZBdHRMb3dlciIpXSkNCiAgIyBmaXggZWZmZWN0cyBhdCB0aGlzIHZhbHVlDQogIG15ZWZmJGZpeFtteWVmZiRpbmNsdWRlPT1UXSA8LSBUUlVFIA0KICANCiAgIyBJIGFsc28gc3BlY2lmeSBtb2RlbHMgd2l0aCBubyBzb2NpYWwgaW5mbHVlbmNlLCANCiAgbXllZmZfbm9pbmYgPC0gc2V0RWZmZWN0KG15ZWZmLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgbXllZmZfbm9pbmYgPC0gc2V0RWZmZWN0KG15ZWZmX25vaW5mLCBhdkF0dExvd2VyLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSAwLCBmaXggPSBUUlVFKQ0KICAjIG9ubHkgdXB3YXJkIGFzc2ltaWxhdGlvbiwNCiAgbXllZmZfbm9sb3cgPC0gc2V0RWZmZWN0KG15ZWZmLCBhdkF0dExvd2VyLCBuYW1lID0gImZyZXFfcnVuIiwgaW50ZXJhY3Rpb24xID0gImt1ZG9uZXQiLCBpbml0aWFsVmFsdWUgPSAwLCBmaXggPSBUUlVFKQ0KICAjIGFuZCBvbmx5IGRvd253YXJkIGFzc2ltaWxhdGlvbg0KICBteWVmZl9ub2hpZ2ggPC0gc2V0RWZmZWN0KG15ZWZmLCBhdkF0dEhpZ2hlciwgbmFtZSA9ICJmcmVxX3J1biIsIGludGVyYWN0aW9uMSA9ICJrdWRvbmV0IiwgaW5pdGlhbFZhbHVlID0gMCwgZml4ID0gVFJVRSkNCiAgDQogICMgc2V0IHVwIHRoZSBzaW11bGF0aW9uIHNldHRpbmdzDQogIG5JdGVyIDwtIDEwMCAjIG51bWJlciBvZiBpdGVyYXRpb25zDQogIHNpbV9tb2RlbCA8LSBzaWVuYUFsZ29yaXRobUNyZWF0ZSgNCiAgICBwcm9qbmFtZSA9ICdzaW1fdGVzdDEnLA0KICAgIGNvbmQgPSBGQUxTRSwNCiAgICB1c2VTdGRJbml0cyA9IEZBTFNFLCBuc3ViID0gMCwNCiAgICBuMyA9IG5JdGVyLCANCiAgICBzZWVkPTI0MjQ1MiwgIyBzZWVkIGZvciByZXBsaWNhdGlvbg0KICAgIHNpbU9ubHkgPSBUUlVFKQ0KICANCiAgIyBJIHdpbGwgZXh0cmFjdCB0aGUgbWVhbiBydW5uaW5nIGZyZXF1ZW5jeSB2YWx1ZXMgZnJvbSB0aGUgc2ltdWxhdGlvbiBydW5zDQogICMgbWFrZSB2ZWN0b3JzIHRvIHN0b3JlIG1lYW5zDQogIG1lYW5TaW1PIDwtIHJlcCgwLCBuSXRlcikNCiAgbWVhblNpbV9ub2luZiA8LSByZXAoMCwgbkl0ZXIpDQogIG1lYW5TaW1fbm9sb3cgPC0gcmVwKDAsIG5JdGVyKQ0KICBtZWFuU2ltX25vaGlnaCA8LSByZXAoMCwgbkl0ZXIpDQogIA0KICAjIHNpbXVsYXRpb24gdXNpbmcgZXN0aW1hdGVkIHBhcmFtZXRlcnMNCiAgc2ltX2FucyA8LSBzaWVuYTA3KHNpbV9tb2RlbCwgICAgICAgICAgIyBzaW11bGF0aW9uIHNldHRpbmdzDQogICAgICAgICAgICAgICAgICAgICBkYXRhID0gbXlkYXRhLCAgICAgICMgZGF0YQ0KICAgICAgICAgICAgICAgICAgICAgZWZmZWN0cyA9IG15ZWZmLCAgICAjIGRlZmluZWQgZWZmZWN0cyBhbmQgc2V0IHBhcmFtZXRlcnMNCiAgICAgICAgICAgICAgICAgICAgIHJldHVybkRlcHMgPSBUUlVFLCAgIyByZXR1cm4gc2ltdWxhdGVkIG5ldHdvcmtzIGFuZCBiZWhhdmlvcnMNCiAgICAgICAgICAgICAgICAgICAgIHJldHVybkNoYWlucyA9IFRSVUUsIyByZXR1cm4gc2VxdWVuY2VzIG9mIG1pY3JvLXN0ZXBzDQogICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IFRSVUUpDQogIHNpbV9hbnNfbm9pbmYgPC0gc2llbmEwNyhzaW1fbW9kZWwsICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gbXlkYXRhLCAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RzID0gbXllZmZfbm9pbmYsICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5EZXBzID0gVFJVRSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5DaGFpbnMgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBUUlVFKQ0KICBzaW1fYW5zX25vbG93IDwtIHNpZW5hMDcoc2ltX21vZGVsLCAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG15ZGF0YSwgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0cyA9IG15ZWZmX25vbG93LCAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ2hhaW5zID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gVFJVRSkNCiAgc2ltX2Fuc19ub2hpZ2ggPC0gc2llbmEwNyhzaW1fbW9kZWwsICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG15ZGF0YSwgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVmZmVjdHMgPSBteWVmZl9ub2hpZ2gsICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuRGVwcyA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkNoYWlucyA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBUUlVFKQ0KICANCiAgIyBleHRyYWN0IG1lYW4gYmVoYXZpb3IgdmFsdWVzIGZyb20gc2ltdWxhdGlvbiBydW5zDQogIGZvciAoaSBpbiAxOm5JdGVyKSB7DQogICAgbWVhblNpbU9baV0gPC0gbWVhbihzaW1fYW5zJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV0pDQogICAgbWVhblNpbV9ub2luZltpXSA8LSBtZWFuKHNpbV9hbnNfbm9pbmYkc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXSkNCiAgICBtZWFuU2ltX25vbG93W2ldIDwtIG1lYW4oc2ltX2Fuc19ub2xvdyRzaW1zW1tpXV1bWzFdXSRmcmVxX3J1bltbMV1dKQ0KICAgIG1lYW5TaW1fbm9oaWdoW2ldIDwtIG1lYW4oc2ltX2Fuc19ub2hpZ2gkc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXSkNCiAgfQ0KICAjc3RyKHNpbV9hbnMkc2ltc1tbMV1dKSAjIG51bWJlcmluZyBpcyBhcyBmb2xsb3dzOiBuSXRlciwgZ3JvdXAgbnVtYmVyLCBEViwgcGVyaW9kIG51bWJlcg0KICANCiAgIyBhbHNvIHN0b3JlIG9ic2VydmVkIG1lYW4gZnJlcV9ydW4gYXQgdDINCiAgbWVhbk9icyA8LSBtZWFuKGNsdWIkZnJlcV9ydW5bLCwyXSkNCiAgDQogICMgIG1ha2UgYSBsYXlvdXQgZm9yIHRoZSBwbG90cw0KICBkZXYub2ZmKCkNCiAgbCA8LSBsYXlvdXQobWF0cml4KGMoMSwgMSwgNiwgNiwgICMgRmlyc3QNCiAgICAgICAgICAgICAgICAgICAgICAgMiwgMywgNCwgNSksICMgYW5kIHRoaXJkIHBsb3QNCiAgICAgICAgICAgICAgICAgICAgIG5yb3cgPSAyLA0KICAgICAgICAgICAgICAgICAgICAgbmNvbCA9IDQsDQogICAgICAgICAgICAgICAgICAgICBieXJvdyA9IFRSVUUpKQ0KICAjbGF5b3V0LnNob3cobCkNCiAgDQogICMgbWFrZSBkYXRhIGZvciBwbG90dGluZw0KICBwbG90X2RhdGEgPC0gcmJpbmQoDQogICAgZGF0YS5mcmFtZShjb25kPSJPYnNlcnZlZCIsIG1lYW4gPSBtZWFuU2ltTyksDQogICAgZGF0YS5mcmFtZShjb25kPSJOb19pbmYiLCBtZWFuID0gbWVhblNpbV9ub2luZiksDQogICAgZGF0YS5mcmFtZShjb25kPSJOb19hdkF0dEwiLCBtZWFuID0gbWVhblNpbV9ub2xvdyksDQogICAgZGF0YS5mcmFtZShjb25kPSJOb19hdkF0dEgiLCBtZWFuID0gbWVhblNpbV9ub2hpZ2gpDQogICkNCiAgDQogICMgcmVvcmRlciBjb25kaXRpb25zDQogIHBsb3RfZGF0YSRjb25kIDwtIGZhY3RvcihwbG90X2RhdGEkY29uZCwgbGV2ZWxzPWMoIk9ic2VydmVkIiwgIk5vX2luZiIsICJOb19hdkF0dEwiLCAiTm9fYXZBdHRIIikpDQogIGNvbG9yIDwtIGJyZXdlci5wYWwoNCwgIlNldDMiKSAjIGdldCBjb2xvcnMgZm9yIGJveHBsb3RzDQogIGJveHBsb3QobWVhbiB+IGNvbmQsIGRhdGEgPSBwbG90X2RhdGEsIG1haW4gPSBwYXN0ZSgiU2ltdWxhdGlvbiByZXN1bHRzIGFjcm9zcyIsIG5JdGVyLCAiaXRlcmF0aW9ucyIpLA0KICAgICAgICAgIHhsYWIgPSAiU2ltdWxhdGlvbiIsIHlsYWIgPSAiQXZlcmFnZSBydW5uaW5nIGZyZXF1ZW5jeSIsIGNvbCA9IGNvbG9yKQ0KICBhYmxpbmUoaD1tZWFuT2JzLCBjb2wgPSAiYnJvd24iKSAjIGFkZCB0aGUgb2JzZXJ2ZWQgbWVhbiBydW5uaW5nIGF0IHQyDQogIA0KICAjIEkgZXhhbWluZSB0aGUgcnVubmluZyBmcmVxdWVuY3kgY2hhbmdlcyBpbiBncmVhdGVyIGRldGFpbA0KICBuX2FjdG9ycyA8LSBjbHViJG5ldHNpemUNCiAgDQogIFpzNSA8LSBhcnJheShOQSwgZGltPWMobl9hY3RvcnMsMSkpDQogIFpiNSA8LSBhcnJheSAoMCwgZGltPWMobkl0ZXIsMSkpDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGZvciAoaiBpbiAxOm5fYWN0b3JzKSB7DQogICAgICAjIHNpbXVsYXRlZCBiZWhhdmlvciBvZiBhY3RvciBqIGluIGl0ZXJhdGlvbiBpDQogICAgICBaczVbaiwxXSA8LSBzaW1fYW5zJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV1bW2pdXSANCiAgICB9DQogICAgIyBtZWFuIHNpbXVsYXRlZCBiZWhhdmlvciBvdmVyIGFjdG9ycyBpbiBpdGVyYXRpb24gaQ0KICAgIFpiNVtpXSA8LWNvbFN1bXMoWnM1LCBuYS5ybT1UKS9uX2FjdG9ycw0KICB9DQogIA0KICAjY29sTWVhbnMoY2JpbmQoY2x1YiRmcmVxX3J1blssLDE6Ml0pKSAjIG9ic2VydmVkIG1lYW5zIGF0IHQxIGFuZCB0Mg0KICAjY29sTWVhbnMoWmI1KSAgIyBhdmVyYWdlIG1lYW4gc2ltdWxhdGVkIGJlaGF2aW9yIHZhbHVlDQogICNtZWFuKCBzaW1fYW5zJHNpbXNbW25JdGVyXV1bWzFdXSRmcmVxX3J1bltbMV1dICkjIG1lYW4gb2YgbGFzdCBzaW11bGF0aW9uIHJ1bg0KICANCiAgDQogICMgSSBwbG90IHRoZSBtZWFuIHNpbXVsYXRlZCBydW5uaW5nIGZyZXF1ZW5jeSBvdmVyIHRpbWUgDQogICMgZXh0cmFjdCBtZWFuIGRyaW5raW5nIGZvciBhbGwgY2hhaW5zLCB3aXRoIG5ldHdvcmsgY2hhbmdlIG9wcG9ydHVuaXRpZXMgaW5jbHVkZWQNCiAgc2ltQ2hhbmdlcyA8LSByZXAoMCwgbkl0ZXIpDQogIGZvciAoaSBpbiAxOiBuSXRlcikge3NpbUNoYW5nZXNbaV0gPC0gbGVuZ3RoKHNpbV9hbnMkY2hhaW5bW2ldXVtbMV1dW1sxXV0pIH0NCiAgbWF4Q2hhbmdlcyA8LSBtYXgoc2ltQ2hhbmdlcykNCiAgDQogIHNlcXMgPC0gbWF0cml4KFpiNSwgbnI9IG5JdGVyLCBuYz1tYXhDaGFuZ2VzKzEpICAjIGZpbGwgbWF0cml4IHdpdGggZmluYWwgbWVhbg0KICBzZXFzWywxXSA8LSBtZWFuKGNsdWIkZnJlcV9ydW5bLCwxXSkgICAjIHNldCB0MSBtZWFuIHRvIG9ic2VydmVkIGxldmVsDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGRhdENoYWluIDwtIHQobWF0cml4KHVubGlzdChzaW1fYW5zJGNoYWluW1tpXV1bWzFdXVtbMV1dKSwgbmM9bGVuZ3RoKHNpbV9hbnMkY2hhaW5bW2ldXVtbMV1dW1sxXV0pKSkgDQogICAgZm9yIChqIGluIDE6IHNpbUNoYW5nZXNbaV0pIHsNCiAgICAgIGlmIChkYXRDaGFpbltqLDJdPT0iMCIpIHsgDQogICAgICAgIHNlcXNbaSxqKzFdIDwtIHNlcXNbaSxqXQ0KICAgICAgfQ0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIxIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdICsgKGFzLm51bWVyaWMoZGF0Q2hhaW5baiw2XSkvbl9hY3RvcnMpDQogICAgICB9DQogICAgfQ0KICB9DQogICMgcGxvdCBtdWx0aXBsZSBpdGVyYXRpb25zIHVzaW5nIGxvZXNzIGN1cnZlcw0KICBtaWNyb3MgPC0gMTpkaW0oc2VxcylbMl0NCiAgbG8xIDwtIGxvZXNzKHNlcXNbMSxdIH4gbWljcm9zKQ0KICBsMSA8LSBwcmVkaWN0KGxvMSwgbWljcm9zKQ0KICANCiAgIyBzZXQgeWxpbTsgc28gaXQgaXMgY29uc2lzdGVudCBhY3Jvc3MgcGxvdHMNCiAgeW1pbiA8LSBwbHlyOjpyb3VuZF9hbnkobWluKHNlcXMpLCAuNSwgZj1mbG9vcikNCiAgeW1heCA8LSBwbHlyOjpyb3VuZF9hbnkobWF4KHNlcXMpLCAuNSwgZj1jZWlsaW5nKQ0KICANCiAgcGxvdCh4PTE6ZGltKHNlcXMpWzJdLCB5PXNlcXNbMSxdLCB5bGltPWMoeW1pbix5bWF4KSx0eXBlPSJsIiwgDQogICAgICAgeWxhYj0nQXZlcmFnZSBydW5uaW5nIGZyZXF1ZW5jeScsIHhsYWI9J01pY3JvLXN0ZXAnLCBjb2w9J3doaXRlJywNCiAgICAgICBtYWluPSdNZWFuIHJ1bm5pbmcgb3ZlciB0aW1lOg0KICAgICBmdWxsIG1vZGVsJykJDQogIGZvciAoaSBpbiAxOjI1KSB7DQogICAgbGluZXMoeD1taWNyb3MsIHk9cHJlZGljdChsb2VzcyhzZXFzW2ksXSB+IG1pY3JvcyksIG1pY3JvcyksIGNvbD1jb2xvcnMoKVtpKjEwXSkNCiAgfQ0KICANCiAgIyBkbyB0aGUgc2FtZSBmb3IgdGhlIG1vZGVsIHdpdGggbm8gcGVlciBpbmZsdWVuY2Ugd2hhdHNvZXZlci4gDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGZvciAoaiBpbiAxOm5fYWN0b3JzKSB7DQogICAgICAjIHNpbXVsYXRlZCBiZWhhdmlvciBvZiBhY3RvciBqIGluIGl0ZXJhdGlvbiBpDQogICAgICBaczVbaiwxXSA8LSBzaW1fYW5zX25vaW5mJHNpbXNbW2ldXVtbMV1dJGZyZXFfcnVuW1sxXV1bW2pdXSANCiAgICB9DQogICAgIyBtZWFuIHNpbXVsYXRlZCBiZWhhdmlvciBvdmVyIGFjdG9ycyBpbiBpdGVyYXRpb24gaQ0KICAgIFpiNVtpXSA8LWNvbFN1bXMoWnM1LCBuYS5ybT1UKS9uX2FjdG9ycw0KICB9DQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGRhdENoYWluIDwtIHQobWF0cml4KHVubGlzdChzaW1fYW5zX25vaW5mJGNoYWluW1tpXV1bWzFdXVtbMV1dKSwgbmM9bGVuZ3RoKHNpbV9hbnNfbm9pbmYkY2hhaW5bW2ldXVtbMV1dW1sxXV0pKSkgDQogICAgZm9yIChqIGluIDE6IHNpbUNoYW5nZXNbaV0pIHsNCiAgICAgIGlmIChkYXRDaGFpbltqLDJdPT0iMCIpIHsgDQogICAgICAgIHNlcXNbaSxqKzFdIDwtIHNlcXNbaSxqXQ0KICAgICAgfQ0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIxIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdICsgKGFzLm51bWVyaWMoZGF0Q2hhaW5baiw2XSkvbl9hY3RvcnMpDQogICAgICB9DQogICAgfQ0KICB9DQogIG1pY3JvcyA8LSAxOmRpbShzZXFzKVsyXQ0KICBsbzEgPC0gbG9lc3Moc2Vxc1sxLF0gfiBtaWNyb3MpDQogIGwxIDwtIHByZWRpY3QobG8xLCBtaWNyb3MpDQogIA0KICBwbG90KHg9MTpkaW0oc2VxcylbMl0sIHk9c2Vxc1sxLF0sIHlsaW09Yyh5bWluLHltYXgpLHR5cGU9ImwiLCANCiAgICAgICB5bGFiPSdBdmVyYWdlIHJ1bm5pbmcgZnJlcXVlbmN5JywgeGxhYj0nTWljcm8tc3RlcCcsIGNvbD0nd2hpdGUnLA0KICAgICAgIG1haW49J01lYW4gcnVubmluZyBvdmVyIHRpbWU6DQogICAgIG5vIGluZmx1ZW5jZScpCQ0KICBmb3IgKGkgaW4gMToyNSkgew0KICAgIGxpbmVzKHg9bWljcm9zLCB5PXByZWRpY3QobG9lc3Moc2Vxc1tpLF0gfiBtaWNyb3MpLCBtaWNyb3MpLCBjb2w9Y29sb3JzKClbaSoxMF0pDQogIH0NCiAgDQogICMgbm8gZG93bndhcmQgYXNzaW1pbGF0aW9uLiANCiAgZm9yIChpIGluIDE6IG5JdGVyKSB7DQogICAgZm9yIChqIGluIDE6bl9hY3RvcnMpIHsNCiAgICAgICMgc2ltdWxhdGVkIGJlaGF2aW9yIG9mIGFjdG9yIGogaW4gaXRlcmF0aW9uIGkNCiAgICAgIFpzNVtqLDFdIDwtIHNpbV9hbnNfbm9sb3ckc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXVtbal1dIA0KICAgIH0NCiAgICAjIG1lYW4gc2ltdWxhdGVkIGJlaGF2aW9yIG92ZXIgYWN0b3JzIGluIGl0ZXJhdGlvbiBpDQogICAgWmI1W2ldIDwtY29sU3VtcyhaczUsIG5hLnJtPVQpL25fYWN0b3JzDQogIH0NCiAgDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGRhdENoYWluIDwtIHQobWF0cml4KHVubGlzdChzaW1fYW5zX25vbG93JGNoYWluW1tpXV1bWzFdXVtbMV1dKSwgbmM9bGVuZ3RoKHNpbV9hbnNfbm9sb3ckY2hhaW5bW2ldXVtbMV1dW1sxXV0pKSkgDQogICAgZm9yIChqIGluIDE6IHNpbUNoYW5nZXNbaV0pIHsNCiAgICAgIGlmIChkYXRDaGFpbltqLDJdPT0iMCIpIHsgDQogICAgICAgIHNlcXNbaSxqKzFdIDwtIHNlcXNbaSxqXQ0KICAgICAgfQ0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIxIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdICsgKGFzLm51bWVyaWMoZGF0Q2hhaW5baiw2XSkvbl9hY3RvcnMpDQogICAgICB9DQogICAgfQ0KICB9DQogIG1pY3JvcyA8LSAxOmRpbShzZXFzKVsyXQ0KICBsbzEgPC0gbG9lc3Moc2Vxc1sxLF0gfiBtaWNyb3MpDQogIGwxIDwtIHByZWRpY3QobG8xLCBtaWNyb3MpDQogIA0KICBwbG90KHg9MTpkaW0oc2VxcylbMl0sIHk9c2Vxc1sxLF0sIHlsaW09Yyh5bWluLHltYXgpLHR5cGU9ImwiLCANCiAgICAgICB5bGFiPSdBdmVyYWdlIHJ1bm5pbmcgZnJlcXVlbmN5JywgeGxhYj0nTWljcm8tc3RlcCcsIGNvbD0nd2hpdGUnLA0KICAgICAgIG1haW49J01lYW4gcnVubmluZyBvdmVyIHRpbWU6DQogICAgIG5vIGF2QXR0TG93ZXInKQkNCiAgZm9yIChpIGluIDE6MjUpIHsNCiAgICBsaW5lcyh4PW1pY3JvcywgeT1wcmVkaWN0KGxvZXNzKHNlcXNbaSxdIH4gbWljcm9zKSwgbWljcm9zKSwgY29sPWNvbG9ycygpW2kqMTBdKQ0KICB9DQogIA0KICAjIG5vIHVwd2FyZCBhc3NpbWlsYXRpb24uIA0KICBmb3IgKGkgaW4gMTogbkl0ZXIpIHsNCiAgICBmb3IgKGogaW4gMTpuX2FjdG9ycykgew0KICAgICAgIyBzaW11bGF0ZWQgYmVoYXZpb3Igb2YgYWN0b3IgaiBpbiBpdGVyYXRpb24gaQ0KICAgICAgWnM1W2osMV0gPC0gc2ltX2Fuc19ub2hpZ2gkc2ltc1tbaV1dW1sxXV0kZnJlcV9ydW5bWzFdXVtbal1dIA0KICAgIH0NCiAgICAjIG1lYW4gc2ltdWxhdGVkIGJlaGF2aW9yIG92ZXIgYWN0b3JzIGluIGl0ZXJhdGlvbiBpDQogICAgWmI1W2ldIDwtY29sU3VtcyhaczUsIG5hLnJtPVQpL25fYWN0b3JzDQogIH0NCiAgDQogIGZvciAoaSBpbiAxOiBuSXRlcikgew0KICAgIGRhdENoYWluIDwtIHQobWF0cml4KHVubGlzdChzaW1fYW5zX25vaGlnaCRjaGFpbltbaV1dW1sxXV1bWzFdXSksIG5jPWxlbmd0aChzaW1fYW5zX25vaGlnaCRjaGFpbltbaV1dW1sxXV1bWzFdXSkpKSANCiAgICBmb3IgKGogaW4gMTogc2ltQ2hhbmdlc1tpXSkgew0KICAgICAgaWYgKGRhdENoYWluW2osMl09PSIwIikgeyANCiAgICAgICAgc2Vxc1tpLGorMV0gPC0gc2Vxc1tpLGpdDQogICAgICB9DQogICAgICBpZiAoZGF0Q2hhaW5baiwyXT09IjEiKSB7IA0KICAgICAgICBzZXFzW2ksaisxXSA8LSBzZXFzW2ksal0gKyAoYXMubnVtZXJpYyhkYXRDaGFpbltqLDZdKS9uX2FjdG9ycykNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgbWljcm9zIDwtIDE6ZGltKHNlcXMpWzJdDQogIGxvMSA8LSBsb2VzcyhzZXFzWzEsXSB+IG1pY3JvcykNCiAgbDEgPC0gcHJlZGljdChsbzEsIG1pY3JvcykNCiAgDQogIHBsb3QoeD0xOmRpbShzZXFzKVsyXSwgeT1zZXFzWzEsXSwgeWxpbT1jKHltaW4seW1heCksdHlwZT0ibCIsIA0KICAgICAgIHlsYWI9J0F2ZXJhZ2UgcnVubmluZyBmcmVxdWVuY3knLCB4bGFiPSdNaWNyby1zdGVwJywgY29sPSd3aGl0ZScsDQogICAgICAgbWFpbj0nTWVhbiBydW5uaW5nIG92ZXIgdGltZToNCiAgICAgbm8gYXZBdHRIaWdoZXInKQkNCiAgZm9yIChpIGluIDE6MjUpIHsNCiAgICBsaW5lcyh4PW1pY3JvcywgeT1wcmVkaWN0KGxvZXNzKHNlcXNbaSxdIH4gbWljcm9zKSwgbWljcm9zKSwgY29sPWNvbG9ycygpW2kqMTBdKQ0KICB9DQogIA0KICAjc2F2ZSB0aGUgcGxvdCB0byB0aGUgbGlzdA0KICBwbG90TFtbY11dIDwtIHJlY29yZFBsb3QoKQ0KDQp9DQoNCmBgYA0KDQo8YnI+DQoNCiMgUGxvdHMgey50YWJzZXQgLnRhYnNldC1mYWRlfQ0KDQojIyBjbHViIDENCg0KIVtdKHBsb3RzX2NsdWIxLnBuZykNCg0KIyMgY2x1YiAyDQoNCiFbXShwbG90c19jbHViMi5wbmcpDQoNCiMjIGNsdWIgMw0KDQohW10ocGxvdHNfY2x1YjMucG5nKQ0KDQojIyBjbHViIDQNCg0KIVtdKHBsb3RzX2NsdWI0LnBuZykNCg0KIyMgY2x1YiA1DQoNCiFbXShwbG90c19jbHViNS5wbmcpDQoNCiMgey19</div>
<style>
.center {
  text-align: center;
  color: red;
}
</style>

<hr>
<br>
<p class="center">Copyright &copy; 2021 Rob Franken</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("simulations.rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
